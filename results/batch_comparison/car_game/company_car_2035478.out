=== Company Car Game - 10 Iterations ===
Job ID: 2035478, Node: jn004
=== Environment Check ===
CUDA: True, GPU: NVIDIA L40
NVIDIA L40, 49140 MiB, 1 MiB
=== Verifying Torch Scope Fix ===
âœ… Torch scope fix is present
=== Running Company Car Game - 10 Iterations ===
Game: Employee vs Manager company car negotiation

=== Iteration 1/300 ===
Wed Nov 19 03:57:57 PM CET 2025: Starting company car negotiation iteration 1 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 28.74s (total since entry 29.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.48s (total since entry 11.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2000.00, model_b surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 2000.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43000.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2000.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 1 completed successfully
Wed Nov 19 03:58:49 PM CET 2025: Completed iteration 1

=== Iteration 2/300 ===
Wed Nov 19 03:58:49 PM CET 2025: Starting company car negotiation iteration 2 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.03s (total since entry 14.57s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.77s (total since entry 7.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 2 completed successfully
Wed Nov 19 03:59:30 PM CET 2025: Completed iteration 2

=== Iteration 3/300 ===
Wed Nov 19 03:59:30 PM CET 2025: Starting company car negotiation iteration 3 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.63s (total since entry 14.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.85s (total since entry 6.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 3 completed successfully
Wed Nov 19 04:00:13 PM CET 2025: Completed iteration 3

=== Iteration 4/300 ===
Wed Nov 19 04:00:13 PM CET 2025: Starting company car negotiation iteration 4 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 18.33s (total since entry 18.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.89s (total since entry 6.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29000.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬29,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1615.00 (saved â‚¬-1615.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3585.00 (profit â‚¬3585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38770.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1615.00, model_a surplus=3585.00
âœ… Calculated utility_surplus: {'model_a': 3585.0, 'model_b': -1615.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 38770.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3585.0, 'model_b': -1615.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 4 completed successfully
Wed Nov 19 04:00:47 PM CET 2025: Completed iteration 4

=== Iteration 5/300 ===
Wed Nov 19 04:00:47 PM CET 2025: Starting company car negotiation iteration 5 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 17.49s (total since entry 18.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.72s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 5 completed successfully
Wed Nov 19 04:01:27 PM CET 2025: Completed iteration 5

=== Iteration 6/300 ===
Wed Nov 19 04:01:27 PM CET 2025: Starting company car negotiation iteration 6 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.52s (total since entry 14.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.93s (total since entry 6.49s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 182.54 (saved â‚¬182.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1728.81 (profit â‚¬1728.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39365.07, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=182.54, model_a surplus=1728.81
âœ… Calculated utility_surplus: {'model_a': 1728.8066250000047, 'model_b': 182.53662499999336}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39365.07324999999, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1728.8066250000047, 'model_b': 182.53662499999336}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 6 completed successfully
Wed Nov 19 04:02:04 PM CET 2025: Completed iteration 6

=== Iteration 7/300 ===
Wed Nov 19 04:02:04 PM CET 2025: Starting company car negotiation iteration 7 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.65s (total since entry 14.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.69s (total since entry 6.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38250\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38250\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38250\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38410}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38410}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38410}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38410}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38410}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38410.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,410 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38367\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38367\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38367\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38367}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38367}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38367.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,367 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 7 completed successfully
Wed Nov 19 04:02:39 PM CET 2025: Completed iteration 7

=== Iteration 8/300 ===
Wed Nov 19 04:02:39 PM CET 2025: Starting company car negotiation iteration 8 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.00s (total since entry 14.56s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.40s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.87s (total since entry 6.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1885.00, model_b surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 1885.0, 'model_b': 85.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 42270.0, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1885.0, 'model_b': 85.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 8 completed successfully
Wed Nov 19 04:03:11 PM CET 2025: Completed iteration 8

=== Iteration 9/300 ===
Wed Nov 19 04:03:11 PM CET 2025: Starting company car negotiation iteration 9 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 18.93s (total since entry 19.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 7.62s (total since entry 8.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,385 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39150}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39150}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39150}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39150}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39150}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39150.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬39,150 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 9 completed successfully
Wed Nov 19 04:03:56 PM CET 2025: Completed iteration 9

=== Iteration 10/300 ===
Wed Nov 19 04:03:56 PM CET 2025: Starting company car negotiation iteration 10 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.07s (total since entry 11.59s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.67s (total since entry 6.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38900\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38900\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38900\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38900.0}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,900 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,750 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -155.20 (saved â‚¬-155.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2037.87 (profit â‚¬2037.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38439.60, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-155.20, model_b surplus=2037.87
âœ… Calculated utility_surplus: {'model_a': -155.2014243750018, 'model_b': 2037.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38439.59715125, 'model_b': 38750.0}
Metrics: {'utility_surplus': {'model_a': -155.2014243750018, 'model_b': 2037.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 10 completed successfully
Wed Nov 19 04:04:30 PM CET 2025: Completed iteration 10

=== Iteration 11/300 ===
Wed Nov 19 04:04:30 PM CET 2025: Starting company car negotiation iteration 11 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.36s (total since entry 12.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.82s (total since entry 6.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38475\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38475\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38475\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38475}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38475}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38475.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,475 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 11 completed successfully
Wed Nov 19 04:05:00 PM CET 2025: Completed iteration 11

=== Iteration 12/300 ===
Wed Nov 19 04:05:00 PM CET 2025: Starting company car negotiation iteration 12 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.31s (total since entry 11.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.69s (total since entry 5.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,250 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=385.00, model_a surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 1585.0, 'model_b': 385.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 40770.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1585.0, 'model_b': 385.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 12 completed successfully
Wed Nov 19 04:05:26 PM CET 2025: Completed iteration 12

=== Iteration 13/300 ===
Wed Nov 19 04:05:26 PM CET 2025: Starting company car negotiation iteration 13 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.26s (total since entry 9.79s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.21s (total since entry 4.64s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 779.22 (saved â‚¬779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1161.22 (profit â‚¬1161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40558.45, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=779.22, model_a surplus=1161.22
âœ… Calculated utility_surplus: {'model_a': 1161.2249999999985, 'model_b': 779.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40558.45, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1161.2249999999985, 'model_b': 779.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 13 completed successfully
Wed Nov 19 04:05:54 PM CET 2025: Completed iteration 13

=== Iteration 14/300 ===
Wed Nov 19 04:05:54 PM CET 2025: Starting company car negotiation iteration 14 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.02s (total since entry 10.58s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.22s (total since entry 4.68s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 885.00 (saved â‚¬885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1085.00 (profit â‚¬1085.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41270.00, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=885.00, model_a surplus=1085.00
âœ… Calculated utility_surplus: {'model_a': 1085.0, 'model_b': 885.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41270.0, 'model_a': 39500.0}
Metrics: {'utility_surplus': {'model_a': 1085.0, 'model_b': 885.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 14 completed successfully
Wed Nov 19 04:06:20 PM CET 2025: Completed iteration 14

=== Iteration 15/300 ===
Wed Nov 19 04:06:20 PM CET 2025: Starting company car negotiation iteration 15 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.71s (total since entry 11.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.55s (total since entry 4.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 15 completed successfully
Wed Nov 19 04:06:41 PM CET 2025: Completed iteration 15

=== Iteration 16/300 ===
Wed Nov 19 04:06:41 PM CET 2025: Starting company car negotiation iteration 16 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.49s (total since entry 13.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.27s (total since entry 5.68s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36271}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36271}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36271}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36271}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36271}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36271.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬36,271 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 16 completed successfully
Wed Nov 19 04:07:14 PM CET 2025: Completed iteration 16

=== Iteration 17/300 ===
Wed Nov 19 04:07:14 PM CET 2025: Starting company car negotiation iteration 17 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.76s (total since entry 11.34s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.21s (total since entry 4.62s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 17 completed successfully
Wed Nov 19 04:07:39 PM CET 2025: Completed iteration 17

=== Iteration 18/300 ===
Wed Nov 19 04:07:39 PM CET 2025: Starting company car negotiation iteration 18 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.64s (total since entry 9.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.14s (total since entry 4.55s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38800\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38800\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38800\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,800 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37623}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37623}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37623}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37623}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37623}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37623.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,623 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,623 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37623
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 971.80 (saved â‚¬971.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 910.87 (profit â‚¬910.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39566.60, seller=37623.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=971.80, model_a surplus=910.87
âœ… Calculated utility_surplus: {'model_a': 910.8745256249967, 'model_b': 971.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39566.59715125, 'model_a': 37623.0}
Metrics: {'utility_surplus': {'model_a': 910.8745256249967, 'model_b': 971.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 18 completed successfully
Wed Nov 19 04:08:06 PM CET 2025: Completed iteration 18

=== Iteration 19/300 ===
Wed Nov 19 04:08:06 PM CET 2025: Starting company car negotiation iteration 19 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.77s (total since entry 9.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.96s (total since entry 4.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 19 completed successfully
Wed Nov 19 04:08:25 PM CET 2025: Completed iteration 19

=== Iteration 20/300 ===
Wed Nov 19 04:08:25 PM CET 2025: Starting company car negotiation iteration 20 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.15s (total since entry 9.69s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.87s (total since entry 4.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 20 completed successfully
Wed Nov 19 04:08:54 PM CET 2025: Completed iteration 20

=== Iteration 21/300 ===
Wed Nov 19 04:08:54 PM CET 2025: Starting company car negotiation iteration 21 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.71s (total since entry 11.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.11s (total since entry 4.56s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1885.00, model_b surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 1885.0, 'model_b': 85.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 42270.0, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1885.0, 'model_b': 85.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 21 completed successfully
Wed Nov 19 04:09:18 PM CET 2025: Completed iteration 21

=== Iteration 22/300 ===
Wed Nov 19 04:09:18 PM CET 2025: Starting company car negotiation iteration 22 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.14s (total since entry 9.67s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.29s (total since entry 4.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1379.22 (saved â‚¬1379.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 561.22 (profit â‚¬561.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41158.45, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1379.22, model_b surplus=561.22
âœ… Calculated utility_surplus: {'model_a': 1379.2249999999985, 'model_b': 561.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41158.45, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 1379.2249999999985, 'model_b': 561.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 22 completed successfully
Wed Nov 19 04:09:40 PM CET 2025: Completed iteration 22

=== Iteration 23/300 ===
Wed Nov 19 04:09:40 PM CET 2025: Starting company car negotiation iteration 23 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.93s (total since entry 9.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.10s (total since entry 4.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
4, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,400 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1379.22 (saved â‚¬1379.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 561.22 (profit â‚¬561.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41158.45, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1379.22, model_b surplus=561.22
âœ… Calculated utility_surplus: {'model_a': 1379.2249999999985, 'model_b': 561.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41158.45, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 1379.2249999999985, 'model_b': 561.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 23 completed successfully
Wed Nov 19 04:10:05 PM CET 2025: Completed iteration 23

=== Iteration 24/300 ===
Wed Nov 19 04:10:05 PM CET 2025: Starting company car negotiation iteration 24 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.82s (total since entry 9.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.87s (total since entry 4.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,500 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 279.22 (saved â‚¬279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1661.22 (profit â‚¬1661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40058.45, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=279.22, model_b surplus=1661.22
âœ… Calculated utility_surplus: {'model_a': 279.22499999999854, 'model_b': 1661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40058.45, 'model_b': 39500.0}
Metrics: {'utility_surplus': {'model_a': 279.22499999999854, 'model_b': 1661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 24 completed successfully
Wed Nov 19 04:10:30 PM CET 2025: Completed iteration 24

=== Iteration 25/300 ===
Wed Nov 19 04:10:30 PM CET 2025: Starting company car negotiation iteration 25 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.64s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.70s (total since entry 9.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.69s (total since entry 4.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,750 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -605.20 (saved â‚¬-605.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2487.87 (profit â‚¬2487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=37989.60, seller=39200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-605.20, model_a surplus=2487.87
âœ… Calculated utility_surplus: {'model_a': 2487.8745256249967, 'model_b': -605.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 37989.59715125, 'model_a': 39200.0}
Metrics: {'utility_surplus': {'model_a': 2487.8745256249967, 'model_b': -605.2014243750018}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 25 completed successfully
Wed Nov 19 04:11:03 PM CET 2025: Completed iteration 25

=== Iteration 26/300 ===
Wed Nov 19 04:11:03 PM CET 2025: Starting company car negotiation iteration 26 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.01s (total since entry 9.54s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.74s (total since entry 4.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1385.00, model_a surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 585.0, 'model_b': 1385.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41770.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 585.0, 'model_b': 1385.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 26 completed successfully
Wed Nov 19 04:11:27 PM CET 2025: Completed iteration 26

=== Iteration 27/300 ===
Wed Nov 19 04:11:27 PM CET 2025: Starting company car negotiation iteration 27 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.61s (total since entry 10.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.50s (total since entry 5.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38760\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38760\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38760\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38760}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38760}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38760.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,760 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1379.22 (saved â‚¬1379.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 561.22 (profit â‚¬561.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41158.45, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1379.22, model_b surplus=561.22
âœ… Calculated utility_surplus: {'model_a': 1379.2249999999985, 'model_b': 561.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41158.45, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 1379.2249999999985, 'model_b': 561.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 27 completed successfully
Wed Nov 19 04:11:53 PM CET 2025: Completed iteration 27

=== Iteration 28/300 ===
Wed Nov 19 04:11:53 PM CET 2025: Starting company car negotiation iteration 28 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.37s (total since entry 10.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.76s (total since entry 5.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬37,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-405.20, model_b surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38189.59715125, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 28 completed successfully
Wed Nov 19 04:12:20 PM CET 2025: Completed iteration 28

=== Iteration 29/300 ===
Wed Nov 19 04:12:20 PM CET 2025: Starting company car negotiation iteration 29 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.76s (total since entry 10.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.12s (total since entry 4.68s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬39,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1500.00 (saved â‚¬1500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 500.00 (profit â‚¬500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42500.00, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1500.00, model_a surplus=500.00
âœ… Calculated utility_surplus: {'model_a': 500.0, 'model_b': 1500.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42500.0, 'model_a': 39500.0}
Metrics: {'utility_surplus': {'model_a': 500.0, 'model_b': 1500.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 29 completed successfully
Wed Nov 19 04:12:44 PM CET 2025: Completed iteration 29

=== Iteration 30/300 ===
Wed Nov 19 04:12:44 PM CET 2025: Starting company car negotiation iteration 30 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.01s (total since entry 10.61s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.82s (total since entry 5.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,385 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬38,750 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 432.54 (saved â‚¬432.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1478.81 (profit â‚¬1478.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39615.07, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=432.54, model_a surplus=1478.81
âœ… Calculated utility_surplus: {'model_a': 1478.8066250000047, 'model_b': 432.53662499999336}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39615.07324999999, 'model_a': 38750.0}
Metrics: {'utility_surplus': {'model_a': 1478.8066250000047, 'model_b': 432.53662499999336}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 30 completed successfully
Wed Nov 19 04:13:10 PM CET 2025: Completed iteration 30

=== Iteration 31/300 ===
Wed Nov 19 04:13:10 PM CET 2025: Starting company car negotiation iteration 31 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.53s (total since entry 10.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.23s (total since entry 4.64s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 31 completed successfully
Wed Nov 19 04:13:37 PM CET 2025: Completed iteration 31

=== Iteration 32/300 ===
Wed Nov 19 04:13:37 PM CET 2025: Starting company car negotiation iteration 32 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.30s (total since entry 10.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.28s (total since entry 4.70s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29500.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬29,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1615.00 (saved â‚¬-1615.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3585.00 (profit â‚¬3585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38770.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1615.00, model_a surplus=3585.00
âœ… Calculated utility_surplus: {'model_a': 3585.0, 'model_b': -1615.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 38770.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3585.0, 'model_b': -1615.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 32 completed successfully
Wed Nov 19 04:14:00 PM CET 2025: Completed iteration 32

=== Iteration 33/300 ===
Wed Nov 19 04:14:00 PM CET 2025: Starting company car negotiation iteration 33 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.53s (total since entry 10.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.78s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 33 completed successfully
Wed Nov 19 04:14:33 PM CET 2025: Completed iteration 33

=== Iteration 34/300 ===
Wed Nov 19 04:14:33 PM CET 2025: Starting company car negotiation iteration 34 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.30s (total since entry 10.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.67s (total since entry 5.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 27000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 27000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 27000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 27000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬27,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39200\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39200\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39200\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 34 completed successfully
Wed Nov 19 04:15:08 PM CET 2025: Completed iteration 34

=== Iteration 35/300 ===
Wed Nov 19 04:15:08 PM CET 2025: Starting company car negotiation iteration 35 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.79s (total since entry 10.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.65s (total since entry 5.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40975}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40975}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40975}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40975}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40975}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40975.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,975 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 35 completed successfully
Wed Nov 19 04:15:44 PM CET 2025: Completed iteration 35

=== Iteration 36/300 ===
Wed Nov 19 04:15:44 PM CET 2025: Starting company car negotiation iteration 36 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.49s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.65s (total since entry 9.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.25s (total since entry 4.67s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
12, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38885\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38885\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38885\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38885}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38885}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38885.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,885 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 36 completed successfully
Wed Nov 19 04:16:11 PM CET 2025: Completed iteration 36

=== Iteration 37/300 ===
Wed Nov 19 04:16:11 PM CET 2025: Starting company car negotiation iteration 37 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.85s (total since entry 9.37s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.86s (total since entry 4.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 37 completed successfully
Wed Nov 19 04:16:31 PM CET 2025: Completed iteration 37

=== Iteration 38/300 ===
Wed Nov 19 04:16:31 PM CET 2025: Starting company car negotiation iteration 38 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.52s (total since entry 9.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.81s (total since entry 4.35s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 41000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 41000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 41000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_b made offer â‚¬40,385 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬41,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=41000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1220.78 (saved â‚¬-1220.78 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3161.22 (profit â‚¬3161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38558.45, seller=41000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1220.78, model_a surplus=3161.22
âœ… Calculated utility_surplus: {'model_a': 3161.2249999999985, 'model_b': -1220.7750000000015}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 38558.45, 'model_a': 41000.0}
Metrics: {'utility_surplus': {'model_a': 3161.2249999999985, 'model_b': -1220.7750000000015}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 38 completed successfully
Wed Nov 19 04:16:54 PM CET 2025: Completed iteration 38

=== Iteration 39/300 ===
Wed Nov 19 04:16:54 PM CET 2025: Starting company car negotiation iteration 39 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.53s (total since entry 9.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.83s (total since entry 4.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 39 completed successfully
Wed Nov 19 04:17:18 PM CET 2025: Completed iteration 39

=== Iteration 40/300 ===
Wed Nov 19 04:17:18 PM CET 2025: Starting company car negotiation iteration 40 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.41s (total since entry 8.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.03s (total since entry 4.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬40,900 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37850}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37850}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37850}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37850}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37850}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37850.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 41000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 41000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 41000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_b made offer â‚¬37,850 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38510}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38510}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38510}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38510}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38510}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38510.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 40 completed successfully
Wed Nov 19 04:17:53 PM CET 2025: Completed iteration 40

=== Iteration 41/300 ===
Wed Nov 19 04:17:53 PM CET 2025: Starting company car negotiation iteration 41 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.48s (total since entry 9.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.72s (total since entry 4.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39200\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39200\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39200\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,200 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38800\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38800\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38800\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,800 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 41 completed successfully
Wed Nov 19 04:18:29 PM CET 2025: Completed iteration 41

=== Iteration 42/300 ===
Wed Nov 19 04:18:29 PM CET 2025: Starting company car negotiation iteration 42 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.71s (total since entry 9.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.88s (total since entry 4.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 42 completed successfully
Wed Nov 19 04:18:48 PM CET 2025: Completed iteration 42

=== Iteration 43/300 ===
Wed Nov 19 04:18:48 PM CET 2025: Starting company car negotiation iteration 43 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.64s (total since entry 9.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.18s (total since entry 4.64s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38765}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38765}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38765}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38765}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38765}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38765.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,765 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38410}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38410}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38410}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38410}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38410}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38410.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,410 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38420}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38420}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38420}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38420}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38420}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38420.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,420 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,420 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38420
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 174.80 (saved â‚¬174.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1707.87 (profit â‚¬1707.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38769.60, seller=38420.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=174.80, model_b surplus=1707.87
âœ… Calculated utility_surplus: {'model_a': 174.7985756249982, 'model_b': 1707.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38769.59715125, 'model_b': 38420.0}
Metrics: {'utility_surplus': {'model_a': 174.7985756249982, 'model_b': 1707.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 43 completed successfully
Wed Nov 19 04:19:19 PM CET 2025: Completed iteration 43

=== Iteration 44/300 ===
Wed Nov 19 04:19:19 PM CET 2025: Starting company car negotiation iteration 44 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.52s (total since entry 9.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.19s (total since entry 4.60s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
3, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38800\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38800\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38800\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,800 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 44 completed successfully
Wed Nov 19 04:19:48 PM CET 2025: Completed iteration 44

=== Iteration 45/300 ===
Wed Nov 19 04:19:48 PM CET 2025: Starting company car negotiation iteration 45 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.36s (total since entry 8.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.77s (total since entry 4.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=385.00, model_a surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 1585.0, 'model_b': 385.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 40770.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1585.0, 'model_b': 385.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 45 completed successfully
Wed Nov 19 04:20:11 PM CET 2025: Completed iteration 45

=== Iteration 46/300 ===
Wed Nov 19 04:20:11 PM CET 2025: Starting company car negotiation iteration 46 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.58s (total since entry 9.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.90s (total since entry 4.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38100\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38100\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38100\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 46 completed successfully
Wed Nov 19 04:20:40 PM CET 2025: Completed iteration 46

=== Iteration 47/300 ===
Wed Nov 19 04:20:40 PM CET 2025: Starting company car negotiation iteration 47 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.40s (total since entry 9.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.19s (total since entry 4.61s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1385.00, model_a surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 585.0, 'model_b': 1385.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41770.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 585.0, 'model_b': 1385.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 47 completed successfully
Wed Nov 19 04:21:07 PM CET 2025: Completed iteration 47

=== Iteration 48/300 ===
Wed Nov 19 04:21:07 PM CET 2025: Starting company car negotiation iteration 48 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.86s (total since entry 11.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.68s (total since entry 5.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬42,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 48 completed successfully
Wed Nov 19 04:21:31 PM CET 2025: Completed iteration 48

=== Iteration 49/300 ===
Wed Nov 19 04:21:31 PM CET 2025: Starting company car negotiation iteration 49 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.66s (total since entry 9.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.75s (total since entry 4.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=385.00, model_a surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 1585.0, 'model_b': 385.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 40770.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1585.0, 'model_b': 385.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 49 completed successfully
Wed Nov 19 04:21:53 PM CET 2025: Completed iteration 49

=== Iteration 50/300 ===
Wed Nov 19 04:21:53 PM CET 2025: Starting company car negotiation iteration 50 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.31s (total since entry 11.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.27s (total since entry 4.68s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬39,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1500.00 (saved â‚¬1500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 500.00 (profit â‚¬500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42500.00, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1500.00, model_b surplus=500.00
âœ… Calculated utility_surplus: {'model_a': 1500.0, 'model_b': 500.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42500.0, 'model_b': 39500.0}
Metrics: {'utility_surplus': {'model_a': 1500.0, 'model_b': 500.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 50 completed successfully
Wed Nov 19 04:22:15 PM CET 2025: Completed iteration 50

=== Iteration 51/300 ===
Wed Nov 19 04:22:15 PM CET 2025: Starting company car negotiation iteration 51 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.68s (total since entry 9.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.78s (total since entry 4.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 51 completed successfully
Wed Nov 19 04:22:33 PM CET 2025: Completed iteration 51

=== Iteration 52/300 ===
Wed Nov 19 04:22:33 PM CET 2025: Starting company car negotiation iteration 52 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.74s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.55s (total since entry 9.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 1.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.77s (total since entry 5.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 52 completed successfully
Wed Nov 19 04:22:59 PM CET 2025: Completed iteration 52

=== Iteration 53/300 ===
Wed Nov 19 04:22:59 PM CET 2025: Starting company car negotiation iteration 53 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.29s (total since entry 8.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.85s (total since entry 4.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38765}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38765}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38765}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38765}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38765}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38765.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,765 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,400 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1379.22 (saved â‚¬1379.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 561.22 (profit â‚¬561.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41158.45, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1379.22, model_b surplus=561.22
âœ… Calculated utility_surplus: {'model_a': 1379.2249999999985, 'model_b': 561.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41158.45, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 1379.2249999999985, 'model_b': 561.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 53 completed successfully
Wed Nov 19 04:23:23 PM CET 2025: Completed iteration 53

=== Iteration 54/300 ===
Wed Nov 19 04:23:23 PM CET 2025: Starting company car negotiation iteration 54 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.34s (total since entry 8.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.85s (total since entry 4.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 54 completed successfully
Wed Nov 19 04:23:41 PM CET 2025: Completed iteration 54

=== Iteration 55/300 ===
Wed Nov 19 04:23:41 PM CET 2025: Starting company car negotiation iteration 55 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.46s (total since entry 9.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.82s (total since entry 4.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1279.22, model_b surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41058.45, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 55 completed successfully
Wed Nov 19 04:24:05 PM CET 2025: Completed iteration 55

=== Iteration 56/300 ===
Wed Nov 19 04:24:05 PM CET 2025: Starting company car negotiation iteration 56 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.34s (total since entry 15.87s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.63s (total since entry 7.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38779\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38779\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38779\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38779}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38779}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38779.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,779 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-5.20, model_b surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38589.59715125, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 56 completed successfully
Wed Nov 19 04:24:47 PM CET 2025: Completed iteration 56

=== Iteration 57/300 ===
Wed Nov 19 04:24:47 PM CET 2025: Starting company car negotiation iteration 57 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.14s (total since entry 13.67s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.75s (total since entry 6.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-405.20, model_b surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38189.59715125, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 57 completed successfully
Wed Nov 19 04:25:22 PM CET 2025: Completed iteration 57

=== Iteration 58/300 ===
Wed Nov 19 04:25:22 PM CET 2025: Starting company car negotiation iteration 58 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.31s (total since entry 13.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.62s (total since entry 7.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬39,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1500.00 (saved â‚¬1500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 500.00 (profit â‚¬500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42500.00, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1500.00, model_a surplus=500.00
âœ… Calculated utility_surplus: {'model_a': 500.0, 'model_b': 1500.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42500.0, 'model_a': 39500.0}
Metrics: {'utility_surplus': {'model_a': 500.0, 'model_b': 1500.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 58 completed successfully
Wed Nov 19 04:25:48 PM CET 2025: Completed iteration 58

=== Iteration 59/300 ===
Wed Nov 19 04:25:48 PM CET 2025: Starting company car negotiation iteration 59 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.59s (total since entry 14.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.19s (total since entry 5.61s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 27000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 27000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 27000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 27000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬27,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1885.00 (saved â‚¬1885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 85.00 (profit â‚¬85.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42270.00, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1885.00, model_a surplus=85.00
âœ… Calculated utility_surplus: {'model_a': 85.0, 'model_b': 1885.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 42270.0, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 85.0, 'model_b': 1885.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 59 completed successfully
Wed Nov 19 04:26:16 PM CET 2025: Completed iteration 59

=== Iteration 60/300 ===
Wed Nov 19 04:26:16 PM CET 2025: Starting company car negotiation iteration 60 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.67s (total since entry 14.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.36s (total since entry 5.77s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37916}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37916}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37916}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37916}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37916}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37916.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,916 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37271}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37271}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37271}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37271}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37271}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37271.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,271 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 60 completed successfully
Wed Nov 19 04:26:52 PM CET 2025: Completed iteration 60

=== Iteration 61/300 ===
Wed Nov 19 04:26:52 PM CET 2025: Starting company car negotiation iteration 61 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.48s (total since entry 14.00s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.93s (total since entry 5.35s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 61 completed successfully
Wed Nov 19 04:27:21 PM CET 2025: Completed iteration 61

=== Iteration 62/300 ===
Wed Nov 19 04:27:21 PM CET 2025: Starting company car negotiation iteration 62 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.56s (total since entry 14.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.61s (total since entry 6.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38765\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38765\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38765\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38765}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38765}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38765.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_a made offer â‚¬38,765 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1279.22, model_b surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41058.45, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 62 completed successfully
Wed Nov 19 04:27:53 PM CET 2025: Completed iteration 62

=== Iteration 63/300 ===
Wed Nov 19 04:27:53 PM CET 2025: Starting company car negotiation iteration 63 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.55s (total since entry 14.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.52s (total since entry 5.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,385 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1179.22 (saved â‚¬1179.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 761.22 (profit â‚¬761.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40958.45, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1179.22, model_a surplus=761.22
âœ… Calculated utility_surplus: {'model_a': 761.2249999999985, 'model_b': 1179.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40958.45, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 761.2249999999985, 'model_b': 1179.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 63 completed successfully
Wed Nov 19 04:28:21 PM CET 2025: Completed iteration 63

=== Iteration 64/300 ===
Wed Nov 19 04:28:21 PM CET 2025: Starting company car negotiation iteration 64 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.58s (total since entry 14.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.56s (total since entry 5.97s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 64 completed successfully
Wed Nov 19 04:28:53 PM CET 2025: Completed iteration 64

=== Iteration 65/300 ===
Wed Nov 19 04:28:53 PM CET 2025: Starting company car negotiation iteration 65 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.10s (total since entry 14.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.59s (total since entry 6.00s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 65 completed successfully
Wed Nov 19 04:29:22 PM CET 2025: Completed iteration 65

=== Iteration 66/300 ===
Wed Nov 19 04:29:22 PM CET 2025: Starting company car negotiation iteration 66 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.52s (total since entry 14.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.74s (total since entry 6.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
âœ… Player model_b accepted offer of â‚¬38,750 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1635.00 (saved â‚¬1635.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 335.00 (profit â‚¬335.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42020.00, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1635.00, model_a surplus=335.00
âœ… Calculated utility_surplus: {'model_a': 335.0, 'model_b': 1635.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 42020.0, 'model_a': 38750.0}
Metrics: {'utility_surplus': {'model_a': 335.0, 'model_b': 1635.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 66 completed successfully
Wed Nov 19 04:29:53 PM CET 2025: Completed iteration 66

=== Iteration 67/300 ===
Wed Nov 19 04:29:53 PM CET 2025: Starting company car negotiation iteration 67 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.41s (total since entry 14.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.74s (total since entry 6.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 67 completed successfully
Wed Nov 19 04:30:20 PM CET 2025: Completed iteration 67

=== Iteration 68/300 ===
Wed Nov 19 04:30:20 PM CET 2025: Starting company car negotiation iteration 68 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.69s (total since entry 15.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.76s (total since entry 7.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29500.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬29,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=385.00, model_a surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 1585.0, 'model_b': 385.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 40770.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1585.0, 'model_b': 385.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 68 completed successfully
Wed Nov 19 04:30:51 PM CET 2025: Completed iteration 68

=== Iteration 69/300 ===
Wed Nov 19 04:30:51 PM CET 2025: Starting company car negotiation iteration 69 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.63s (total since entry 14.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.71s (total since entry 6.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=385.00, model_b surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 385.0, 'model_b': 1585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 40770.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 385.0, 'model_b': 1585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 69 completed successfully
Wed Nov 19 04:31:18 PM CET 2025: Completed iteration 69

=== Iteration 70/300 ===
Wed Nov 19 04:31:18 PM CET 2025: Starting company car negotiation iteration 70 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.61s (total since entry 14.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.49s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.55s (total since entry 6.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: -220.78 (saved â‚¬-220.78 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2161.22 (profit â‚¬2161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39558.45, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-220.78, model_b surplus=2161.22
âœ… Calculated utility_surplus: {'model_a': -220.77500000000146, 'model_b': 2161.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 39558.45, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': -220.77500000000146, 'model_b': 2161.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 70 completed successfully
Wed Nov 19 04:31:46 PM CET 2025: Completed iteration 70

=== Iteration 71/300 ===
Wed Nov 19 04:31:46 PM CET 2025: Starting company car negotiation iteration 71 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.98s (total since entry 15.57s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.47s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.91s (total since entry 6.39s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬40,385 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38761}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38761}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38761}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38761}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38761}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38761.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,761 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬38,761 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=38761
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1018.22 (saved â‚¬1018.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 922.22 (profit â‚¬922.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40797.45, seller=38761.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1018.22, model_a surplus=922.22
âœ… Calculated utility_surplus: {'model_a': 922.2249999999985, 'model_b': 1018.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40797.45, 'model_a': 38761.0}
Metrics: {'utility_surplus': {'model_a': 922.2249999999985, 'model_b': 1018.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 71 completed successfully
Wed Nov 19 04:32:23 PM CET 2025: Completed iteration 71

=== Iteration 72/300 ===
Wed Nov 19 04:32:23 PM CET 2025: Starting company car negotiation iteration 72 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.32s (total since entry 13.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.04s (total since entry 6.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 72 completed successfully
Wed Nov 19 04:33:00 PM CET 2025: Completed iteration 72

=== Iteration 73/300 ===
Wed Nov 19 04:33:00 PM CET 2025: Starting company car negotiation iteration 73 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.95s (total since entry 13.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.01s (total since entry 6.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38550\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38550\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38550\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,550 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38401}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38401}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38401}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38401}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38401}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38401.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,401 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,401 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38401
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 781.54 (saved â‚¬781.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1129.81 (profit â‚¬1129.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39964.07, seller=38401.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=781.54, model_b surplus=1129.81
âœ… Calculated utility_surplus: {'model_a': 781.5366249999934, 'model_b': 1129.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39964.07324999999, 'model_b': 38401.0}
Metrics: {'utility_surplus': {'model_a': 781.5366249999934, 'model_b': 1129.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 73 completed successfully
Wed Nov 19 04:33:33 PM CET 2025: Completed iteration 73

=== Iteration 74/300 ===
Wed Nov 19 04:33:33 PM CET 2025: Starting company car negotiation iteration 74 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 17.00s (total since entry 17.59s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 7.64s (total since entry 8.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,750 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 432.54 (saved â‚¬432.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1478.81 (profit â‚¬1478.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39615.07, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=432.54, model_b surplus=1478.81
âœ… Calculated utility_surplus: {'model_a': 432.53662499999336, 'model_b': 1478.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39615.07324999999, 'model_b': 38750.0}
Metrics: {'utility_surplus': {'model_a': 432.53662499999336, 'model_b': 1478.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 74 completed successfully
Wed Nov 19 04:34:10 PM CET 2025: Completed iteration 74

=== Iteration 75/300 ===
Wed Nov 19 04:34:10 PM CET 2025: Starting company car negotiation iteration 75 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.56s (total since entry 15.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.44s (total since entry 6.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬37,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-5.20, model_b surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38589.59715125, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 75 completed successfully
Wed Nov 19 04:34:52 PM CET 2025: Completed iteration 75

=== Iteration 76/300 ===
Wed Nov 19 04:34:52 PM CET 2025: Starting company car negotiation iteration 76 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.58s (total since entry 14.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.78s (total since entry 7.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1000.00, model_a surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42000.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 76 completed successfully
Wed Nov 19 04:35:22 PM CET 2025: Completed iteration 76

=== Iteration 77/300 ===
Wed Nov 19 04:35:22 PM CET 2025: Starting company car negotiation iteration 77 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.64s (total since entry 14.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.69s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬36,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,750 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 432.54 (saved â‚¬432.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1478.81 (profit â‚¬1478.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39615.07, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=432.54, model_a surplus=1478.81
âœ… Calculated utility_surplus: {'model_a': 1478.8066250000047, 'model_b': 432.53662499999336}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39615.07324999999, 'model_a': 38750.0}
Metrics: {'utility_surplus': {'model_a': 1478.8066250000047, 'model_b': 432.53662499999336}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 77 completed successfully
Wed Nov 19 04:36:00 PM CET 2025: Completed iteration 77

=== Iteration 78/300 ===
Wed Nov 19 04:36:00 PM CET 2025: Starting company car negotiation iteration 78 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.20s (total since entry 14.72s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.83s (total since entry 6.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38475}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38475}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38475}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38475}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38475}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38475.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,475 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,475 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38475
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 119.80 (saved â‚¬119.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1762.87 (profit â‚¬1762.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38714.60, seller=38475.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=119.80, model_b surplus=1762.87
âœ… Calculated utility_surplus: {'model_a': 119.7985756249982, 'model_b': 1762.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38714.59715125, 'model_b': 38475.0}
Metrics: {'utility_surplus': {'model_a': 119.7985756249982, 'model_b': 1762.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 78 completed successfully
Wed Nov 19 04:36:32 PM CET 2025: Completed iteration 78

=== Iteration 79/300 ===
Wed Nov 19 04:36:32 PM CET 2025: Starting company car negotiation iteration 79 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.19s (total since entry 15.72s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.76s (total since entry 6.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39200\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39200\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39200\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,100 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1594.80 (saved â‚¬1594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 287.87 (profit â‚¬287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40189.60, seller=37000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1594.80, model_a surplus=287.87
âœ… Calculated utility_surplus: {'model_a': 287.87452562499675, 'model_b': 1594.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 40189.59715125, 'model_a': 37000.0}
Metrics: {'utility_surplus': {'model_a': 287.87452562499675, 'model_b': 1594.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 79 completed successfully
Wed Nov 19 04:37:11 PM CET 2025: Completed iteration 79

=== Iteration 80/300 ===
Wed Nov 19 04:37:11 PM CET 2025: Starting company car negotiation iteration 80 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.33s (total since entry 13.85s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.87s (total since entry 6.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,385 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 80 completed successfully
Wed Nov 19 04:37:46 PM CET 2025: Completed iteration 80

=== Iteration 81/300 ===
Wed Nov 19 04:37:46 PM CET 2025: Starting company car negotiation iteration 81 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.22s (total since entry 15.74s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.40s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.81s (total since entry 7.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,999 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,750 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬37,750 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 844.80 (saved â‚¬844.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1037.87 (profit â‚¬1037.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39439.60, seller=37750.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=844.80, model_a surplus=1037.87
âœ… Calculated utility_surplus: {'model_a': 1037.8745256249967, 'model_b': 844.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39439.59715125, 'model_a': 37750.0}
Metrics: {'utility_surplus': {'model_a': 1037.8745256249967, 'model_b': 844.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 81 completed successfully
Wed Nov 19 04:38:34 PM CET 2025: Completed iteration 81

=== Iteration 82/300 ===
Wed Nov 19 04:38:34 PM CET 2025: Starting company car negotiation iteration 82 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.07s (total since entry 15.61s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.56s (total since entry 6.97s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
ğŸ’¡ Player model_a made offer â‚¬40,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 82 completed successfully
Wed Nov 19 04:39:10 PM CET 2025: Completed iteration 82

=== Iteration 83/300 ===
Wed Nov 19 04:39:10 PM CET 2025: Starting company car negotiation iteration 83 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.52s (total since entry 14.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.71s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬42,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 83 completed successfully
Wed Nov 19 04:39:38 PM CET 2025: Completed iteration 83

=== Iteration 84/300 ===
Wed Nov 19 04:39:38 PM CET 2025: Starting company car negotiation iteration 84 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.20s (total since entry 13.73s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.85s (total since entry 6.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬37,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38900\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38900\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38900\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38900.0}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,900 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38800\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38800\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38800\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,800 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 84 completed successfully
Wed Nov 19 04:40:13 PM CET 2025: Completed iteration 84

=== Iteration 85/300 ===
Wed Nov 19 04:40:13 PM CET 2025: Starting company car negotiation iteration 85 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.72s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.78s (total since entry 16.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 7.91s (total since entry 8.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1615.00 (saved â‚¬-1615.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3585.00 (profit â‚¬3585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38770.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1615.00, model_a surplus=3585.00
âœ… Calculated utility_surplus: {'model_a': 3585.0, 'model_b': -1615.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 38770.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3585.0, 'model_b': -1615.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 85 completed successfully
Wed Nov 19 04:40:46 PM CET 2025: Completed iteration 85

=== Iteration 86/300 ===
Wed Nov 19 04:40:46 PM CET 2025: Starting company car negotiation iteration 86 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.19s (total since entry 13.75s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.87s (total since entry 6.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40100\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40100\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40100\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,100 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬40,100 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=40100
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: -320.78 (saved â‚¬-320.78 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2261.22 (profit â‚¬2261.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39458.45, seller=40100.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-320.78, model_b surplus=2261.22
âœ… Calculated utility_surplus: {'model_a': -320.77500000000146, 'model_b': 2261.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 39458.45, 'model_b': 40100.0}
Metrics: {'utility_surplus': {'model_a': -320.77500000000146, 'model_b': 2261.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 86 completed successfully
Wed Nov 19 04:41:12 PM CET 2025: Completed iteration 86

=== Iteration 87/300 ===
Wed Nov 19 04:41:12 PM CET 2025: Starting company car negotiation iteration 87 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.04s (total since entry 13.57s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.88s (total since entry 6.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=385.00, model_b surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 385.0, 'model_b': 1585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 40770.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 385.0, 'model_b': 1585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 87 completed successfully
Wed Nov 19 04:41:41 PM CET 2025: Completed iteration 87

=== Iteration 88/300 ===
Wed Nov 19 04:41:41 PM CET 2025: Starting company car negotiation iteration 88 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.76s (total since entry 14.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.80s (total since entry 7.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 88 completed successfully
Wed Nov 19 04:42:17 PM CET 2025: Completed iteration 88

=== Iteration 89/300 ===
Wed Nov 19 04:42:17 PM CET 2025: Starting company car negotiation iteration 89 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.83s (total since entry 14.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.80s (total since entry 6.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 89 completed successfully
Wed Nov 19 04:42:44 PM CET 2025: Completed iteration 89

=== Iteration 90/300 ===
Wed Nov 19 04:42:44 PM CET 2025: Starting company car negotiation iteration 90 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.31s (total since entry 15.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.82s (total since entry 7.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42500.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,500 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 279.22 (saved â‚¬279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1661.22 (profit â‚¬1661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40058.45, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=279.22, model_a surplus=1661.22
âœ… Calculated utility_surplus: {'model_a': 1661.2249999999985, 'model_b': 279.22499999999854}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40058.45, 'model_a': 39500.0}
Metrics: {'utility_surplus': {'model_a': 1661.2249999999985, 'model_b': 279.22499999999854}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 90 completed successfully
Wed Nov 19 04:43:17 PM CET 2025: Completed iteration 90

=== Iteration 91/300 ===
Wed Nov 19 04:43:17 PM CET 2025: Starting company car negotiation iteration 91 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.74s (total since entry 14.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.78s (total since entry 7.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,500 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 279.22 (saved â‚¬279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1661.22 (profit â‚¬1661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40058.45, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=279.22, model_b surplus=1661.22
âœ… Calculated utility_surplus: {'model_a': 279.22499999999854, 'model_b': 1661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40058.45, 'model_b': 39500.0}
Metrics: {'utility_surplus': {'model_a': 279.22499999999854, 'model_b': 1661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 91 completed successfully
Wed Nov 19 04:43:49 PM CET 2025: Completed iteration 91

=== Iteration 92/300 ===
Wed Nov 19 04:43:49 PM CET 2025: Starting company car negotiation iteration 92 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 18.24s (total since entry 18.78s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.82s (total since entry 6.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 92 completed successfully
Wed Nov 19 04:44:20 PM CET 2025: Completed iteration 92

=== Iteration 93/300 ===
Wed Nov 19 04:44:20 PM CET 2025: Starting company car negotiation iteration 93 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.91s (total since entry 11.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 7.95s (total since entry 8.37s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40900.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38839\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38839\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38839\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38839}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38839}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38839.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,839 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 93 completed successfully
Wed Nov 19 04:44:57 PM CET 2025: Completed iteration 93

=== Iteration 94/300 ===
Wed Nov 19 04:44:57 PM CET 2025: Starting company car negotiation iteration 94 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.52s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.37s (total since entry 13.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.00s (total since entry 6.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 94 completed successfully
Wed Nov 19 04:45:26 PM CET 2025: Completed iteration 94

=== Iteration 95/300 ===
Wed Nov 19 04:45:26 PM CET 2025: Starting company car negotiation iteration 95 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.46s (total since entry 14.00s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.40s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.41s (total since entry 6.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,385 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 95 completed successfully
Wed Nov 19 04:46:01 PM CET 2025: Completed iteration 95

=== Iteration 96/300 ===
Wed Nov 19 04:46:01 PM CET 2025: Starting company car negotiation iteration 96 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.38s (total since entry 14.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.72s (total since entry 6.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 182.54 (saved â‚¬182.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1728.81 (profit â‚¬1728.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39365.07, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=182.54, model_b surplus=1728.81
âœ… Calculated utility_surplus: {'model_a': 182.53662499999336, 'model_b': 1728.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39365.07324999999, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 182.53662499999336, 'model_b': 1728.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 96 completed successfully
Wed Nov 19 04:46:34 PM CET 2025: Completed iteration 96

=== Iteration 97/300 ===
Wed Nov 19 04:46:34 PM CET 2025: Starting company car negotiation iteration 97 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.68s (total since entry 14.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.40s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.66s (total since entry 6.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 97 completed successfully
Wed Nov 19 04:47:12 PM CET 2025: Completed iteration 97

=== Iteration 98/300 ===
Wed Nov 19 04:47:12 PM CET 2025: Starting company car negotiation iteration 98 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.63s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.12s (total since entry 13.76s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.91s (total since entry 6.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,500 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 279.22 (saved â‚¬279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1661.22 (profit â‚¬1661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40058.45, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=279.22, model_b surplus=1661.22
âœ… Calculated utility_surplus: {'model_a': 279.22499999999854, 'model_b': 1661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40058.45, 'model_b': 39500.0}
Metrics: {'utility_surplus': {'model_a': 279.22499999999854, 'model_b': 1661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 98 completed successfully
Wed Nov 19 04:47:40 PM CET 2025: Completed iteration 98

=== Iteration 99/300 ===
Wed Nov 19 04:47:40 PM CET 2025: Starting company car negotiation iteration 99 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.13s (total since entry 13.65s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.88s (total since entry 6.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 99 completed successfully
Wed Nov 19 04:48:17 PM CET 2025: Completed iteration 99

=== Iteration 100/300 ===
Wed Nov 19 04:48:17 PM CET 2025: Starting company car negotiation iteration 100 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 21.13s (total since entry 21.67s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.85s (total since entry 6.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 100 completed successfully
Wed Nov 19 04:48:59 PM CET 2025: Completed iteration 100

=== Iteration 101/300 ===
Wed Nov 19 04:48:59 PM CET 2025: Starting company car negotiation iteration 101 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.78s (total since entry 14.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.81s (total since entry 6.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38779}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38779}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38779}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38779}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38779}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38779.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,779 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬38,779 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=38779
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.22 (saved â‚¬1000.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 940.22 (profit â‚¬940.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40779.45, seller=38779.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.22, model_b surplus=940.22
âœ… Calculated utility_surplus: {'model_a': 1000.2249999999985, 'model_b': 940.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40779.45, 'model_b': 38779.0}
Metrics: {'utility_surplus': {'model_a': 1000.2249999999985, 'model_b': 940.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 101 completed successfully
Wed Nov 19 04:49:29 PM CET 2025: Completed iteration 101

=== Iteration 102/300 ===
Wed Nov 19 04:49:29 PM CET 2025: Starting company car negotiation iteration 102 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.69s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.10s (total since entry 15.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.56s (total since entry 6.98s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29700.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬29,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38601\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38601\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38601\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38601}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38601}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38601.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,601 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38601}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38601}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38601}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38601}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38601}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38601.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,601 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 102 completed successfully
Wed Nov 19 04:50:09 PM CET 2025: Completed iteration 102

=== Iteration 103/300 ===
Wed Nov 19 04:50:09 PM CET 2025: Starting company car negotiation iteration 103 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.29s (total since entry 15.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.90s (total since entry 7.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38765}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38765}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38765}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38765}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38765}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38765.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,765 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,765 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=38765
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1014.22 (saved â‚¬1014.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 926.22 (profit â‚¬926.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40793.45, seller=38765.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1014.22, model_b surplus=926.22
âœ… Calculated utility_surplus: {'model_a': 1014.2249999999985, 'model_b': 926.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40793.45, 'model_b': 38765.0}
Metrics: {'utility_surplus': {'model_a': 1014.2249999999985, 'model_b': 926.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 103 completed successfully
Wed Nov 19 04:50:43 PM CET 2025: Completed iteration 103

=== Iteration 104/300 ===
Wed Nov 19 04:50:43 PM CET 2025: Starting company car negotiation iteration 104 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.52s (total since entry 12.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.96s (total since entry 6.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1500.00 (saved â‚¬1500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 500.00 (profit â‚¬500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42500.00, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1500.00, model_a surplus=500.00
âœ… Calculated utility_surplus: {'model_a': 500.0, 'model_b': 1500.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 42500.0, 'model_a': 39500.0}
Metrics: {'utility_surplus': {'model_a': 500.0, 'model_b': 1500.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 104 completed successfully
Wed Nov 19 04:51:08 PM CET 2025: Completed iteration 104

=== Iteration 105/300 ===
Wed Nov 19 04:51:08 PM CET 2025: Starting company car negotiation iteration 105 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.50s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.96s (total since entry 13.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.54s (total since entry 5.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 27000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 27000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 27000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 27000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬27,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,500 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 279.22 (saved â‚¬279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1661.22 (profit â‚¬1661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40058.45, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=279.22, model_b surplus=1661.22
âœ… Calculated utility_surplus: {'model_a': 279.22499999999854, 'model_b': 1661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40058.45, 'model_b': 39500.0}
Metrics: {'utility_surplus': {'model_a': 279.22499999999854, 'model_b': 1661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 105 completed successfully
Wed Nov 19 04:51:39 PM CET 2025: Completed iteration 105

=== Iteration 106/300 ===
Wed Nov 19 04:51:39 PM CET 2025: Starting company car negotiation iteration 106 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.44s (total since entry 12.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.77s (total since entry 7.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38765\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38765\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38765\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38765}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38765}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38765.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,765 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-405.20, model_b surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38189.59715125, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 106 completed successfully
Wed Nov 19 04:52:12 PM CET 2025: Completed iteration 106

=== Iteration 107/300 ===
Wed Nov 19 04:52:12 PM CET 2025: Starting company car negotiation iteration 107 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.30s (total since entry 13.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.42s (total since entry 4.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38800\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38800\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38800\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,800 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 107 completed successfully
Wed Nov 19 04:52:47 PM CET 2025: Completed iteration 107

=== Iteration 108/300 ===
Wed Nov 19 04:52:47 PM CET 2025: Starting company car negotiation iteration 108 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 17.52s (total since entry 18.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.14s (total since entry 4.55s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬29,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1385.00, model_a surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 585.0, 'model_b': 1385.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41770.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 585.0, 'model_b': 1385.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 108 completed successfully
Wed Nov 19 04:53:19 PM CET 2025: Completed iteration 108

=== Iteration 109/300 ===
Wed Nov 19 04:53:19 PM CET 2025: Starting company car negotiation iteration 109 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.49s (total since entry 15.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.23s (total since entry 4.68s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38800\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38800\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38800\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,800 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,800 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38800
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 382.54 (saved â‚¬382.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1528.81 (profit â‚¬1528.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39565.07, seller=38800.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=382.54, model_a surplus=1528.81
âœ… Calculated utility_surplus: {'model_a': 1528.8066250000047, 'model_b': 382.53662499999336}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39565.07324999999, 'model_a': 38800.0}
Metrics: {'utility_surplus': {'model_a': 1528.8066250000047, 'model_b': 382.53662499999336}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 109 completed successfully
Wed Nov 19 04:53:53 PM CET 2025: Completed iteration 109

=== Iteration 110/300 ===
Wed Nov 19 04:53:53 PM CET 2025: Starting company car negotiation iteration 110 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.38s (total since entry 14.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.15s (total since entry 4.61s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29999.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬29,999 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 37000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 37000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 37000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38200\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38200\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38200\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-5.20, model_b surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38589.59715125, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 110 completed successfully
Wed Nov 19 04:54:27 PM CET 2025: Completed iteration 110

=== Iteration 111/300 ===
Wed Nov 19 04:54:27 PM CET 2025: Starting company car negotiation iteration 111 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.58s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.69s (total since entry 13.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.90s (total since entry 6.37s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39100\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39100\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39100\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,100 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37236}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37236}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37236}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37236}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37236}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37236.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,236 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,236 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37236
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1358.80 (saved â‚¬1358.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 523.87 (profit â‚¬523.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39953.60, seller=37236.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1358.80, model_a surplus=523.87
âœ… Calculated utility_surplus: {'model_a': 523.8745256249967, 'model_b': 1358.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39953.59715125, 'model_a': 37236.0}
Metrics: {'utility_surplus': {'model_a': 523.8745256249967, 'model_b': 1358.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 111 completed successfully
Wed Nov 19 04:55:11 PM CET 2025: Completed iteration 111

=== Iteration 112/300 ===
Wed Nov 19 04:55:11 PM CET 2025: Starting company car negotiation iteration 112 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.59s (total since entry 11.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.61s (total since entry 4.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38790}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38790}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38790}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38790}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38790}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38790.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,790 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 112 completed successfully
Wed Nov 19 04:55:37 PM CET 2025: Completed iteration 112

=== Iteration 113/300 ===
Wed Nov 19 04:55:37 PM CET 2025: Starting company car negotiation iteration 113 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.06s (total since entry 14.62s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.20s (total since entry 4.63s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 27600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 27600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 27600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 27600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬27,600 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON after prefix removal: '{\n  "type": "offer",\n  "price": 38900\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38900\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38900\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38900.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,900 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,900 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=38900
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 879.22 (saved â‚¬879.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1061.22 (profit â‚¬1061.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40658.45, seller=38900.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=879.22, model_a surplus=1061.22
âœ… Calculated utility_surplus: {'model_a': 1061.2249999999985, 'model_b': 879.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40658.45, 'model_a': 38900.0}
Metrics: {'utility_surplus': {'model_a': 1061.2249999999985, 'model_b': 879.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 113 completed successfully
Wed Nov 19 04:56:09 PM CET 2025: Completed iteration 113

=== Iteration 114/300 ===
Wed Nov 19 04:56:09 PM CET 2025: Starting company car negotiation iteration 114 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.60s (total since entry 12.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.60s (total since entry 4.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 582.54 (saved â‚¬582.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1328.81 (profit â‚¬1328.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39765.07, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=582.54, model_b surplus=1328.81
âœ… Calculated utility_surplus: {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39765.07324999999, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 114 completed successfully
Wed Nov 19 04:56:34 PM CET 2025: Completed iteration 114

=== Iteration 115/300 ===
Wed Nov 19 04:56:34 PM CET 2025: Starting company car negotiation iteration 115 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.62s (total since entry 12.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.82s (total since entry 4.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬37,900 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,900 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1379.22 (saved â‚¬1379.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 561.22 (profit â‚¬561.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41158.45, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1379.22, model_a surplus=561.22
âœ… Calculated utility_surplus: {'model_a': 561.2249999999985, 'model_b': 1379.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41158.45, 'model_a': 38400.0}
Metrics: {'utility_surplus': {'model_a': 561.2249999999985, 'model_b': 1379.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 115 completed successfully
Wed Nov 19 04:57:02 PM CET 2025: Completed iteration 115

=== Iteration 116/300 ===
Wed Nov 19 04:57:02 PM CET 2025: Starting company car negotiation iteration 116 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.96s (total since entry 10.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.18s (total since entry 5.63s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.00, model_b surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42000.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 116 completed successfully
Wed Nov 19 04:57:25 PM CET 2025: Completed iteration 116

=== Iteration 117/300 ===
Wed Nov 19 04:57:25 PM CET 2025: Starting company car negotiation iteration 117 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.54s (total since entry 13.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.92s (total since entry 4.34s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.00, model_b surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42000.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 117 completed successfully
Wed Nov 19 04:57:48 PM CET 2025: Completed iteration 117

=== Iteration 118/300 ===
Wed Nov 19 04:57:48 PM CET 2025: Starting company car negotiation iteration 118 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.83s (total since entry 12.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.59s (total since entry 4.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: -220.78 (saved â‚¬-220.78 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2161.22 (profit â‚¬2161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39558.45, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-220.78, model_a surplus=2161.22
âœ… Calculated utility_surplus: {'model_a': 2161.2249999999985, 'model_b': -220.77500000000146}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 39558.45, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 2161.2249999999985, 'model_b': -220.77500000000146}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 118 completed successfully
Wed Nov 19 04:58:13 PM CET 2025: Completed iteration 118

=== Iteration 119/300 ===
Wed Nov 19 04:58:13 PM CET 2025: Starting company car negotiation iteration 119 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.68s (total since entry 12.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.62s (total since entry 4.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬42,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 119 completed successfully
Wed Nov 19 04:58:38 PM CET 2025: Completed iteration 119

=== Iteration 120/300 ===
Wed Nov 19 04:58:38 PM CET 2025: Starting company car negotiation iteration 120 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.99s (total since entry 11.57s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.66s (total since entry 4.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,650 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 782.54 (saved â‚¬782.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1128.81 (profit â‚¬1128.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39965.07, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=782.54, model_b surplus=1128.81
âœ… Calculated utility_surplus: {'model_a': 782.5366249999934, 'model_b': 1128.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39965.07324999999, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 782.5366249999934, 'model_b': 1128.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 120 completed successfully
Wed Nov 19 04:59:09 PM CET 2025: Completed iteration 120

=== Iteration 121/300 ===
Wed Nov 19 04:59:09 PM CET 2025: Starting company car negotiation iteration 121 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.24s (total since entry 11.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.61s (total since entry 4.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1385.00, model_a surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 585.0, 'model_b': 1385.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41770.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 585.0, 'model_b': 1385.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 121 completed successfully
Wed Nov 19 04:59:34 PM CET 2025: Completed iteration 121

=== Iteration 122/300 ===
Wed Nov 19 04:59:34 PM CET 2025: Starting company car negotiation iteration 122 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.58s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.67s (total since entry 12.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.58s (total since entry 4.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1279.22, model_b surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41058.45, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 122 completed successfully
Wed Nov 19 04:59:56 PM CET 2025: Completed iteration 122

=== Iteration 123/300 ===
Wed Nov 19 04:59:56 PM CET 2025: Starting company car negotiation iteration 123 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 18.53s (total since entry 19.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.10s (total since entry 5.55s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬40,500 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬40,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=40500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 500.00 (saved â‚¬500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1500.00 (profit â‚¬1500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41500.00, seller=40500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=500.00, model_b surplus=1500.00
âœ… Calculated utility_surplus: {'model_a': 500.0, 'model_b': 1500.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 41500.0, 'model_b': 40500.0}
Metrics: {'utility_surplus': {'model_a': 500.0, 'model_b': 1500.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 123 completed successfully
Wed Nov 19 05:00:29 PM CET 2025: Completed iteration 123

=== Iteration 124/300 ===
Wed Nov 19 05:00:29 PM CET 2025: Starting company car negotiation iteration 124 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.79s (total since entry 13.35s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.80s (total since entry 4.24s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,750 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1029.22 (saved â‚¬1029.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 911.22 (profit â‚¬911.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40808.45, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1029.22, model_b surplus=911.22
âœ… Calculated utility_surplus: {'model_a': 1029.2249999999985, 'model_b': 911.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40808.45, 'model_b': 38750.0}
Metrics: {'utility_surplus': {'model_a': 1029.2249999999985, 'model_b': 911.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 124 completed successfully
Wed Nov 19 05:00:56 PM CET 2025: Completed iteration 124

=== Iteration 125/300 ===
Wed Nov 19 05:00:56 PM CET 2025: Starting company car negotiation iteration 125 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.31s (total since entry 14.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.22s (total since entry 4.65s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 125 completed successfully
Wed Nov 19 05:01:21 PM CET 2025: Completed iteration 125

=== Iteration 126/300 ===
Wed Nov 19 05:01:21 PM CET 2025: Starting company car negotiation iteration 126 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.26s (total since entry 12.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.62s (total since entry 4.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬29,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37650}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37650}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37650}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37650}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37650.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,650 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38401\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38401\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38401\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38401}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38401}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38401.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,401 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 126 completed successfully
Wed Nov 19 05:01:56 PM CET 2025: Completed iteration 126

=== Iteration 127/300 ===
Wed Nov 19 05:01:56 PM CET 2025: Starting company car negotiation iteration 127 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.05s (total since entry 13.63s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.64s (total since entry 4.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1379.22 (saved â‚¬1379.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 561.22 (profit â‚¬561.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41158.45, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1379.22, model_b surplus=561.22
âœ… Calculated utility_surplus: {'model_a': 1379.2249999999985, 'model_b': 561.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41158.45, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 1379.2249999999985, 'model_b': 561.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 127 completed successfully
Wed Nov 19 05:02:27 PM CET 2025: Completed iteration 127

=== Iteration 128/300 ===
Wed Nov 19 05:02:27 PM CET 2025: Starting company car negotiation iteration 128 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.62s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.46s (total since entry 12.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.23s (total since entry 6.66s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39750.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39183}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39183}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39183}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39183}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39183}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39183.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,183 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-405.20, model_a surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38189.59715125, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 128 completed successfully
Wed Nov 19 05:03:02 PM CET 2025: Completed iteration 128

=== Iteration 129/300 ===
Wed Nov 19 05:03:02 PM CET 2025: Starting company car negotiation iteration 129 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.97s (total since entry 13.55s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.61s (total since entry 4.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 129 completed successfully
Wed Nov 19 05:03:29 PM CET 2025: Completed iteration 129

=== Iteration 130/300 ===
Wed Nov 19 05:03:29 PM CET 2025: Starting company car negotiation iteration 130 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.84s (total since entry 13.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.60s (total since entry 4.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 130 completed successfully
Wed Nov 19 05:03:56 PM CET 2025: Completed iteration 130

=== Iteration 131/300 ===
Wed Nov 19 05:03:56 PM CET 2025: Starting company car negotiation iteration 131 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.18s (total since entry 13.73s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.85s (total since entry 4.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 779.22 (saved â‚¬779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1161.22 (profit â‚¬1161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40558.45, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=779.22, model_a surplus=1161.22
âœ… Calculated utility_surplus: {'model_a': 1161.2249999999985, 'model_b': 779.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40558.45, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1161.2249999999985, 'model_b': 779.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 131 completed successfully
Wed Nov 19 05:04:22 PM CET 2025: Completed iteration 131

=== Iteration 132/300 ===
Wed Nov 19 05:04:22 PM CET 2025: Starting company car negotiation iteration 132 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.31s (total since entry 11.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.20s (total since entry 6.65s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 132 completed successfully
Wed Nov 19 05:04:46 PM CET 2025: Completed iteration 132

=== Iteration 133/300 ===
Wed Nov 19 05:04:46 PM CET 2025: Starting company car negotiation iteration 133 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.78s (total since entry 11.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.66s (total since entry 4.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38700\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38700\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38700\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,700 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,700 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38700
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -105.20 (saved â‚¬-105.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1987.87 (profit â‚¬1987.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38489.60, seller=38700.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-105.20, model_b surplus=1987.87
âœ… Calculated utility_surplus: {'model_a': -105.2014243750018, 'model_b': 1987.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38489.59715125, 'model_b': 38700.0}
Metrics: {'utility_surplus': {'model_a': -105.2014243750018, 'model_b': 1987.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 133 completed successfully
Wed Nov 19 05:05:13 PM CET 2025: Completed iteration 133

=== Iteration 134/300 ===
Wed Nov 19 05:05:13 PM CET 2025: Starting company car negotiation iteration 134 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.46s (total since entry 12.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.66s (total since entry 4.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬29,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38100\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38100\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38100\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1094.80, model_a surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39689.59715125, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 134 completed successfully
Wed Nov 19 05:05:44 PM CET 2025: Completed iteration 134

=== Iteration 135/300 ===
Wed Nov 19 05:05:44 PM CET 2025: Starting company car negotiation iteration 135 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.33s (total since entry 12.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.65s (total since entry 4.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬40,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,750 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 432.54 (saved â‚¬432.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1478.81 (profit â‚¬1478.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39615.07, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=432.54, model_b surplus=1478.81
âœ… Calculated utility_surplus: {'model_a': 432.53662499999336, 'model_b': 1478.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39615.07324999999, 'model_b': 38750.0}
Metrics: {'utility_surplus': {'model_a': 432.53662499999336, 'model_b': 1478.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 135 completed successfully
Wed Nov 19 05:06:14 PM CET 2025: Completed iteration 135

=== Iteration 136/300 ===
Wed Nov 19 05:06:14 PM CET 2025: Starting company car negotiation iteration 136 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.13s (total since entry 12.68s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.63s (total since entry 4.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬37,900 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39779}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39779}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39779}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39779}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39779}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39779.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,779 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,200 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39200
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -605.20 (saved â‚¬-605.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2487.87 (profit â‚¬2487.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=37989.60, seller=39200.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-605.20, model_a surplus=2487.87
âœ… Calculated utility_surplus: {'model_a': 2487.8745256249967, 'model_b': -605.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 37989.59715125, 'model_a': 39200.0}
Metrics: {'utility_surplus': {'model_a': 2487.8745256249967, 'model_b': -605.2014243750018}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 136 completed successfully
Wed Nov 19 05:06:48 PM CET 2025: Completed iteration 136

=== Iteration 137/300 ===
Wed Nov 19 05:06:48 PM CET 2025: Starting company car negotiation iteration 137 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.01s (total since entry 13.58s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.60s (total since entry 4.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬42,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 137 completed successfully
Wed Nov 19 05:07:11 PM CET 2025: Completed iteration 137

=== Iteration 138/300 ===
Wed Nov 19 05:07:11 PM CET 2025: Starting company car negotiation iteration 138 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.63s (total since entry 11.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.61s (total since entry 4.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38779\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38779\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38779\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38779}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38779}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38779.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,779 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37271}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37271}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37271}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37271}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37271}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37271.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,271 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37400.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬37,400 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 138 completed successfully
Wed Nov 19 05:07:43 PM CET 2025: Completed iteration 138

=== Iteration 139/300 ===
Wed Nov 19 05:07:43 PM CET 2025: Starting company car negotiation iteration 139 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.59s (total since entry 12.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.66s (total since entry 4.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 41500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 41500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 41500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬41,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬41,500 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=41500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: -2317.46 (saved â‚¬-2317.46 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 4228.81 (profit â‚¬4228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=36865.07, seller=41500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-2317.46, model_a surplus=4228.81
âœ… Calculated utility_surplus: {'model_a': 4228.806625000005, 'model_b': -2317.4633750000066}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 36865.07324999999, 'model_a': 41500.0}
Metrics: {'utility_surplus': {'model_a': 4228.806625000005, 'model_b': -2317.4633750000066}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 139 completed successfully
Wed Nov 19 05:08:10 PM CET 2025: Completed iteration 139

=== Iteration 140/300 ===
Wed Nov 19 05:08:10 PM CET 2025: Starting company car negotiation iteration 140 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.61s (total since entry 11.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.62s (total since entry 4.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 140 completed successfully
Wed Nov 19 05:08:36 PM CET 2025: Completed iteration 140

=== Iteration 141/300 ===
Wed Nov 19 05:08:36 PM CET 2025: Starting company car negotiation iteration 141 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.58s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.38s (total since entry 11.97s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.65s (total since entry 4.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=385.00, model_b surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 385.0, 'model_b': 1585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 40770.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 385.0, 'model_b': 1585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 141 completed successfully
Wed Nov 19 05:09:01 PM CET 2025: Completed iteration 141

=== Iteration 142/300 ===
Wed Nov 19 05:09:01 PM CET 2025: Starting company car negotiation iteration 142 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.92s (total since entry 13.52s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 6.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-5.20, model_b surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38589.59715125, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 142 completed successfully
Wed Nov 19 05:09:38 PM CET 2025: Completed iteration 142

=== Iteration 143/300 ===
Wed Nov 19 05:09:38 PM CET 2025: Starting company car negotiation iteration 143 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.23s (total since entry 13.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.36s (total since entry 4.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=344.80, model_b surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38939.59715125, 'model_b': 38250.0}
Metrics: {'utility_surplus': {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 143 completed successfully
Wed Nov 19 05:10:11 PM CET 2025: Completed iteration 143

=== Iteration 144/300 ===
Wed Nov 19 05:10:11 PM CET 2025: Starting company car negotiation iteration 144 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.77s (total since entry 13.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.43s (total since entry 4.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬40,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38550\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38550\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38550\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,550 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,550 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38550
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 632.54 (saved â‚¬632.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1278.81 (profit â‚¬1278.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39815.07, seller=38550.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=632.54, model_a surplus=1278.81
âœ… Calculated utility_surplus: {'model_a': 1278.8066250000047, 'model_b': 632.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39815.07324999999, 'model_a': 38550.0}
Metrics: {'utility_surplus': {'model_a': 1278.8066250000047, 'model_b': 632.5366249999934}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 144 completed successfully
Wed Nov 19 05:10:44 PM CET 2025: Completed iteration 144

=== Iteration 145/300 ===
Wed Nov 19 05:10:44 PM CET 2025: Starting company car negotiation iteration 145 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.87s (total since entry 13.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.64s (total since entry 4.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬29,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39779}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39779}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39779}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39779}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39779}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39779.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,779 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39268}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39268}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39268}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39268}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39268}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39268.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,268 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 145 completed successfully
Wed Nov 19 05:11:16 PM CET 2025: Completed iteration 145

=== Iteration 146/300 ===
Wed Nov 19 05:11:16 PM CET 2025: Starting company car negotiation iteration 146 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.51s (total since entry 14.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.62s (total since entry 4.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38700\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38700\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38700\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,700 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-5.20, model_b surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38589.59715125, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 146 completed successfully
Wed Nov 19 05:11:47 PM CET 2025: Completed iteration 146

=== Iteration 147/300 ===
Wed Nov 19 05:11:47 PM CET 2025: Starting company car negotiation iteration 147 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.58s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.31s (total since entry 13.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.60s (total since entry 4.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,385 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 41000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 41000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 41000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 147 completed successfully
Wed Nov 19 05:12:22 PM CET 2025: Completed iteration 147

=== Iteration 148/300 ===
Wed Nov 19 05:12:22 PM CET 2025: Starting company car negotiation iteration 148 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.53s (total since entry 14.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.59s (total since entry 4.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 26000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 26000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 26000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 26000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 26000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 26000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬26,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,750 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 432.54 (saved â‚¬432.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1478.81 (profit â‚¬1478.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39615.07, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=432.54, model_b surplus=1478.81
âœ… Calculated utility_surplus: {'model_a': 432.53662499999336, 'model_b': 1478.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39615.07324999999, 'model_b': 38750.0}
Metrics: {'utility_surplus': {'model_a': 432.53662499999336, 'model_b': 1478.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 148 completed successfully
Wed Nov 19 05:12:56 PM CET 2025: Completed iteration 148

=== Iteration 149/300 ===
Wed Nov 19 05:12:56 PM CET 2025: Starting company car negotiation iteration 149 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.58s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 17.43s (total since entry 18.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.44s (total since entry 4.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38765\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38765\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38765\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38765}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38765}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38765.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,765 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 149 completed successfully
Wed Nov 19 05:13:31 PM CET 2025: Completed iteration 149

=== Iteration 150/300 ===
Wed Nov 19 05:13:31 PM CET 2025: Starting company car negotiation iteration 150 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.07s (total since entry 14.62s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.39s (total since entry 4.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40100\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40100\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40100\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,100 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 582.54 (saved â‚¬582.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1328.81 (profit â‚¬1328.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39765.07, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=582.54, model_b surplus=1328.81
âœ… Calculated utility_surplus: {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39765.07324999999, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 150 completed successfully
Wed Nov 19 05:14:04 PM CET 2025: Completed iteration 150

=== Iteration 151/300 ===
Wed Nov 19 05:14:04 PM CET 2025: Starting company car negotiation iteration 151 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.78s (total since entry 14.35s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.11s (total since entry 4.65s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38100}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38100}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38100}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-5.20, model_b surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38589.59715125, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 151 completed successfully
Wed Nov 19 05:14:42 PM CET 2025: Completed iteration 151

=== Iteration 152/300 ===
Wed Nov 19 05:14:42 PM CET 2025: Starting company car negotiation iteration 152 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.20s (total since entry 14.76s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.21s (total since entry 4.63s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38800\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38800\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38800\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,800 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,800 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=38800
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 979.22 (saved â‚¬979.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 961.22 (profit â‚¬961.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40758.45, seller=38800.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=979.22, model_a surplus=961.22
âœ… Calculated utility_surplus: {'model_a': 961.2249999999985, 'model_b': 979.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40758.45, 'model_a': 38800.0}
Metrics: {'utility_surplus': {'model_a': 961.2249999999985, 'model_b': 979.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 152 completed successfully
Wed Nov 19 05:15:09 PM CET 2025: Completed iteration 152

=== Iteration 153/300 ===
Wed Nov 19 05:15:09 PM CET 2025: Starting company car negotiation iteration 153 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.45s (total since entry 14.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.76s (total since entry 4.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-405.20, model_b surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38189.59715125, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 153 completed successfully
Wed Nov 19 05:15:40 PM CET 2025: Completed iteration 153

=== Iteration 154/300 ===
Wed Nov 19 05:15:40 PM CET 2025: Starting company car negotiation iteration 154 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.34s (total since entry 13.91s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.65s (total since entry 4.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 582.54 (saved â‚¬582.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1328.81 (profit â‚¬1328.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39765.07, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=582.54, model_b surplus=1328.81
âœ… Calculated utility_surplus: {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39765.07324999999, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 154 completed successfully
Wed Nov 19 05:16:10 PM CET 2025: Completed iteration 154

=== Iteration 155/300 ===
Wed Nov 19 05:16:10 PM CET 2025: Starting company car negotiation iteration 155 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.01s (total since entry 13.55s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.58s (total since entry 4.00s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38250\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38250\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38250\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 155 completed successfully
Wed Nov 19 05:16:43 PM CET 2025: Completed iteration 155

=== Iteration 156/300 ===
Wed Nov 19 05:16:43 PM CET 2025: Starting company car negotiation iteration 156 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.56s (total since entry 14.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.77s (total since entry 4.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38475}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38475}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38475}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38475}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38475}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38475.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,475 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,475 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38475
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 119.80 (saved â‚¬119.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1762.87 (profit â‚¬1762.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38714.60, seller=38475.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=119.80, model_b surplus=1762.87
âœ… Calculated utility_surplus: {'model_a': 119.7985756249982, 'model_b': 1762.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38714.59715125, 'model_b': 38475.0}
Metrics: {'utility_surplus': {'model_a': 119.7985756249982, 'model_b': 1762.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 156 completed successfully
Wed Nov 19 05:17:16 PM CET 2025: Completed iteration 156

=== Iteration 157/300 ===
Wed Nov 19 05:17:16 PM CET 2025: Starting company car negotiation iteration 157 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.58s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 17.47s (total since entry 18.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.43s (total since entry 5.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬41,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 782.54 (saved â‚¬782.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1128.81 (profit â‚¬1128.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39965.07, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=782.54, model_b surplus=1128.81
âœ… Calculated utility_surplus: {'model_a': 782.5366249999934, 'model_b': 1128.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39965.07324999999, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 782.5366249999934, 'model_b': 1128.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 157 completed successfully
Wed Nov 19 05:17:54 PM CET 2025: Completed iteration 157

=== Iteration 158/300 ===
Wed Nov 19 05:17:54 PM CET 2025: Starting company car negotiation iteration 158 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.06s (total since entry 10.61s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.59s (total since entry 4.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38800\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38800\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38800\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,800 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 158 completed successfully
Wed Nov 19 05:18:26 PM CET 2025: Completed iteration 158

=== Iteration 159/300 ===
Wed Nov 19 05:18:26 PM CET 2025: Starting company car negotiation iteration 159 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.01s (total since entry 11.59s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.02s (total since entry 6.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 159 completed successfully
Wed Nov 19 05:18:54 PM CET 2025: Completed iteration 159

=== Iteration 160/300 ===
Wed Nov 19 05:18:54 PM CET 2025: Starting company car negotiation iteration 160 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.66s (total since entry 11.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.58s (total since entry 4.00s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37625}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37625}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37625}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37625}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37625}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37625.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,625 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 160 completed successfully
Wed Nov 19 05:19:16 PM CET 2025: Completed iteration 160

=== Iteration 161/300 ===
Wed Nov 19 05:19:16 PM CET 2025: Starting company car negotiation iteration 161 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.48s (total since entry 15.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.31s (total since entry 4.74s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.00, model_b surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42000.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 161 completed successfully
Wed Nov 19 05:19:41 PM CET 2025: Completed iteration 161

=== Iteration 162/300 ===
Wed Nov 19 05:19:41 PM CET 2025: Starting company car negotiation iteration 162 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.74s (total since entry 12.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.66s (total since entry 4.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬37,200 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 162 completed successfully
Wed Nov 19 05:20:06 PM CET 2025: Completed iteration 162

=== Iteration 163/300 ===
Wed Nov 19 05:20:06 PM CET 2025: Starting company car negotiation iteration 163 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.18s (total since entry 12.74s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.65s (total since entry 4.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39750.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 163 completed successfully
Wed Nov 19 05:20:37 PM CET 2025: Completed iteration 163

=== Iteration 164/300 ===
Wed Nov 19 05:20:37 PM CET 2025: Starting company car negotiation iteration 164 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.42s (total since entry 13.97s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.68s (total since entry 4.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬29,750 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 164 completed successfully
Wed Nov 19 05:21:10 PM CET 2025: Completed iteration 164

=== Iteration 165/300 ===
Wed Nov 19 05:21:10 PM CET 2025: Starting company car negotiation iteration 165 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 18.13s (total since entry 18.71s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 7.69s (total since entry 8.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬41,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 782.54 (saved â‚¬782.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1128.81 (profit â‚¬1128.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39965.07, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=782.54, model_b surplus=1128.81
âœ… Calculated utility_surplus: {'model_a': 782.5366249999934, 'model_b': 1128.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39965.07324999999, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 782.5366249999934, 'model_b': 1128.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 165 completed successfully
Wed Nov 19 05:21:48 PM CET 2025: Completed iteration 165

=== Iteration 166/300 ===
Wed Nov 19 05:21:48 PM CET 2025: Starting company car negotiation iteration 166 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 17.97s (total since entry 18.55s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.13s (total since entry 5.56s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.00, model_b surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42000.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 166 completed successfully
Wed Nov 19 05:22:17 PM CET 2025: Completed iteration 166

=== Iteration 167/300 ===
Wed Nov 19 05:22:17 PM CET 2025: Starting company car negotiation iteration 167 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.69s (total since entry 14.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.89s (total since entry 4.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39200\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39200\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39200\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬39,200 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39183}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39183}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39183}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39183}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39183}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39183.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,183 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-405.20, model_a surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 25.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38189.59715125, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}, 'risk_minimization': {'model_a': 100.0, 'model_b': 25.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 167 completed successfully
Wed Nov 19 05:22:51 PM CET 2025: Completed iteration 167

=== Iteration 168/300 ===
Wed Nov 19 05:22:51 PM CET 2025: Starting company car negotiation iteration 168 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.82s (total since entry 12.37s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.60s (total since entry 4.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 168 completed successfully
Wed Nov 19 05:23:22 PM CET 2025: Completed iteration 168

=== Iteration 169/300 ===
Wed Nov 19 05:23:22 PM CET 2025: Starting company car negotiation iteration 169 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.79s (total since entry 13.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.18s (total since entry 4.60s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 169 completed successfully
Wed Nov 19 05:23:54 PM CET 2025: Completed iteration 169

=== Iteration 170/300 ===
Wed Nov 19 05:23:54 PM CET 2025: Starting company car negotiation iteration 170 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.11s (total since entry 14.67s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.27s (total since entry 4.69s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 779.22 (saved â‚¬779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1161.22 (profit â‚¬1161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40558.45, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=779.22, model_b surplus=1161.22
âœ… Calculated utility_surplus: {'model_a': 779.2249999999985, 'model_b': 1161.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40558.45, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 779.2249999999985, 'model_b': 1161.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 170 completed successfully
Wed Nov 19 05:24:25 PM CET 2025: Completed iteration 170

=== Iteration 171/300 ===
Wed Nov 19 05:24:25 PM CET 2025: Starting company car negotiation iteration 171 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.28s (total since entry 13.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.66s (total since entry 4.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 27900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 27900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 27900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 27900.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬27,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1385.00, model_a surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 585.0, 'model_b': 1385.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41770.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 585.0, 'model_b': 1385.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 171 completed successfully
Wed Nov 19 05:24:53 PM CET 2025: Completed iteration 171

=== Iteration 172/300 ===
Wed Nov 19 05:24:53 PM CET 2025: Starting company car negotiation iteration 172 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.24s (total since entry 12.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.64s (total since entry 4.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=385.00, model_b surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 385.0, 'model_b': 1585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 40770.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 385.0, 'model_b': 1585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 172 completed successfully
Wed Nov 19 05:25:18 PM CET 2025: Completed iteration 172

=== Iteration 173/300 ===
Wed Nov 19 05:25:18 PM CET 2025: Starting company car negotiation iteration 173 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.63s (total since entry 12.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.60s (total since entry 4.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38765\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38765\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38765\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38765}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38765}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38765.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,765 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38601}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38601}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38601}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38601}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38601}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38601.0}
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,601 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 173 completed successfully
Wed Nov 19 05:25:50 PM CET 2025: Completed iteration 173

=== Iteration 174/300 ===
Wed Nov 19 05:25:50 PM CET 2025: Starting company car negotiation iteration 174 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.13s (total since entry 12.69s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.64s (total since entry 4.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 174 completed successfully
Wed Nov 19 05:26:12 PM CET 2025: Completed iteration 174

=== Iteration 175/300 ===
Wed Nov 19 05:26:12 PM CET 2025: Starting company car negotiation iteration 175 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.49s (total since entry 12.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.64s (total since entry 4.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 26900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 26900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 26900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 26900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 26900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 26900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬26,900 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38700\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38700\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38700\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,700 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,700 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38700
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -105.20 (saved â‚¬-105.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1987.87 (profit â‚¬1987.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38489.60, seller=38700.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-105.20, model_a surplus=1987.87
âœ… Calculated utility_surplus: {'model_a': 1987.8745256249967, 'model_b': -105.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38489.59715125, 'model_a': 38700.0}
Metrics: {'utility_surplus': {'model_a': 1987.8745256249967, 'model_b': -105.2014243750018}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 175 completed successfully
Wed Nov 19 05:26:51 PM CET 2025: Completed iteration 175

=== Iteration 176/300 ===
Wed Nov 19 05:26:51 PM CET 2025: Starting company car negotiation iteration 176 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.58s (total since entry 12.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.61s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.65s (total since entry 4.25s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 176 completed successfully
Wed Nov 19 05:27:21 PM CET 2025: Completed iteration 176

=== Iteration 177/300 ===
Wed Nov 19 05:27:21 PM CET 2025: Starting company car negotiation iteration 177 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.83s (total since entry 13.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.68s (total since entry 4.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39250}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39250}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39250}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 177 completed successfully
Wed Nov 19 05:27:58 PM CET 2025: Completed iteration 177

=== Iteration 178/300 ===
Wed Nov 19 05:27:58 PM CET 2025: Starting company car negotiation iteration 178 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.33s (total since entry 13.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.59s (total since entry 4.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39164}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39164}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39164}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39164}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39164}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39164.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬39,164 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 178 completed successfully
Wed Nov 19 05:28:30 PM CET 2025: Completed iteration 178

=== Iteration 179/300 ===
Wed Nov 19 05:28:30 PM CET 2025: Starting company car negotiation iteration 179 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.51s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.26s (total since entry 8.77s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-405.20, model_b surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38189.59715125, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 179 completed successfully
Wed Nov 19 05:29:07 PM CET 2025: Completed iteration 179

=== Iteration 180/300 ===
Wed Nov 19 05:29:07 PM CET 2025: Starting company car negotiation iteration 180 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 18.63s (total since entry 19.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.12s (total since entry 4.54s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 180 completed successfully
Wed Nov 19 05:29:35 PM CET 2025: Completed iteration 180

=== Iteration 181/300 ===
Wed Nov 19 05:29:35 PM CET 2025: Starting company car negotiation iteration 181 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.59s (total since entry 15.19s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.27s (total since entry 4.69s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38475}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38475}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38475}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38475}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38475}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38475.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,475 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-405.20, model_b surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38189.59715125, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 181 completed successfully
Wed Nov 19 05:30:08 PM CET 2025: Completed iteration 181

=== Iteration 182/300 ===
Wed Nov 19 05:30:08 PM CET 2025: Starting company car negotiation iteration 182 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.72s (total since entry 14.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.59s (total since entry 4.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 182 completed successfully
Wed Nov 19 05:30:33 PM CET 2025: Completed iteration 182

=== Iteration 183/300 ===
Wed Nov 19 05:30:33 PM CET 2025: Starting company car negotiation iteration 183 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.95s (total since entry 14.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.94s (total since entry 4.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 27000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 27000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 27000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 27000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬27,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 183 completed successfully
Wed Nov 19 05:31:07 PM CET 2025: Completed iteration 183

=== Iteration 184/300 ===
Wed Nov 19 05:31:07 PM CET 2025: Starting company car negotiation iteration 184 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.41s (total since entry 13.97s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.20s (total since entry 4.62s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬41,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 782.54 (saved â‚¬782.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1128.81 (profit â‚¬1128.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39965.07, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=782.54, model_b surplus=1128.81
âœ… Calculated utility_surplus: {'model_a': 782.5366249999934, 'model_b': 1128.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39965.07324999999, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 782.5366249999934, 'model_b': 1128.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 184 completed successfully
Wed Nov 19 05:31:37 PM CET 2025: Completed iteration 184

=== Iteration 185/300 ===
Wed Nov 19 05:31:37 PM CET 2025: Starting company car negotiation iteration 185 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.89s (total since entry 14.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.21s (total since entry 4.64s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 185 completed successfully
Wed Nov 19 05:32:07 PM CET 2025: Completed iteration 185

=== Iteration 186/300 ===
Wed Nov 19 05:32:07 PM CET 2025: Starting company car negotiation iteration 186 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.88s (total since entry 13.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.95s (total since entry 4.39s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 26000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 26000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 26000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 26000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 26000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 26000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬26,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 186 completed successfully
Wed Nov 19 05:32:34 PM CET 2025: Completed iteration 186

=== Iteration 187/300 ===
Wed Nov 19 05:32:34 PM CET 2025: Starting company car negotiation iteration 187 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.78s (total since entry 12.34s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.63s (total since entry 4.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 27500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 27500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 27500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 27500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬27,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38800\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38800\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38800\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,800 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1179.22 (saved â‚¬1179.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 761.22 (profit â‚¬761.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40958.45, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1179.22, model_a surplus=761.22
âœ… Calculated utility_surplus: {'model_a': 761.2249999999985, 'model_b': 1179.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40958.45, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 761.2249999999985, 'model_b': 1179.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 187 completed successfully
Wed Nov 19 05:33:01 PM CET 2025: Completed iteration 187

=== Iteration 188/300 ===
Wed Nov 19 05:33:01 PM CET 2025: Starting company car negotiation iteration 188 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.25s (total since entry 12.86s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.69s (total since entry 4.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬40,900 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬41,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 188 completed successfully
Wed Nov 19 05:33:30 PM CET 2025: Completed iteration 188

=== Iteration 189/300 ===
Wed Nov 19 05:33:30 PM CET 2025: Starting company car negotiation iteration 189 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.30s (total since entry 13.88s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.68s (total since entry 4.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39100\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39100\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39100\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,100 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38800}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38800}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38800}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬38,800 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b utility=0, model_a utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 189 completed successfully
Wed Nov 19 05:34:08 PM CET 2025: Completed iteration 189

=== Iteration 190/300 ===
Wed Nov 19 05:34:08 PM CET 2025: Starting company car negotiation iteration 190 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.18s (total since entry 13.73s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.57s (total since entry 3.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 190 completed successfully
Wed Nov 19 05:34:31 PM CET 2025: Completed iteration 190

=== Iteration 191/300 ===
Wed Nov 19 05:34:31 PM CET 2025: Starting company car negotiation iteration 191 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.79s (total since entry 13.34s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.62s (total since entry 4.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39250\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39250\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39250\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,250 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 191 completed successfully
Wed Nov 19 05:35:01 PM CET 2025: Completed iteration 191

=== Iteration 192/300 ===
Wed Nov 19 05:35:01 PM CET 2025: Starting company car negotiation iteration 192 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.93s (total since entry 14.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.17s (total since entry 4.58s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1385.00, model_a surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 585.0, 'model_b': 1385.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41770.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 585.0, 'model_b': 1385.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 192 completed successfully
Wed Nov 19 05:35:30 PM CET 2025: Completed iteration 192

=== Iteration 193/300 ===
Wed Nov 19 05:35:30 PM CET 2025: Starting company car negotiation iteration 193 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.53s (total since entry 15.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.15s (total since entry 4.57s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37143}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37143}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37143}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37143}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37143}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37143.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,143 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 193 completed successfully
Wed Nov 19 05:35:59 PM CET 2025: Completed iteration 193

=== Iteration 194/300 ===
Wed Nov 19 05:35:59 PM CET 2025: Starting company car negotiation iteration 194 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.54s (total since entry 13.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.78s (total since entry 4.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 194 completed successfully
Wed Nov 19 05:36:26 PM CET 2025: Completed iteration 194

=== Iteration 195/300 ===
Wed Nov 19 05:36:26 PM CET 2025: Starting company car negotiation iteration 195 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.45s (total since entry 11.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.70s (total since entry 4.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1785.00 (saved â‚¬1785.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 185.00 (profit â‚¬185.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42170.00, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1785.00, model_a surplus=185.00
âœ… Calculated utility_surplus: {'model_a': 185.0, 'model_b': 1785.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 42170.0, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 185.0, 'model_b': 1785.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 195 completed successfully
Wed Nov 19 05:36:51 PM CET 2025: Completed iteration 195

=== Iteration 196/300 ===
Wed Nov 19 05:36:51 PM CET 2025: Starting company car negotiation iteration 196 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.25s (total since entry 11.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.59s (total since entry 4.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,250 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38999\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38999\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38999\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38999}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38999.0}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,999 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 196 completed successfully
Wed Nov 19 05:37:19 PM CET 2025: Completed iteration 196

=== Iteration 197/300 ===
Wed Nov 19 05:37:19 PM CET 2025: Starting company car negotiation iteration 197 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.70s (total since entry 12.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.93s (total since entry 4.37s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38415}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38415}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38415}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38415}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38415}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38415.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,415 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38999\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38999\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38999\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38999}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38999.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,999 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 582.54 (saved â‚¬582.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1328.81 (profit â‚¬1328.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39765.07, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=582.54, model_b surplus=1328.81
âœ… Calculated utility_surplus: {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39765.07324999999, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 197 completed successfully
Wed Nov 19 05:37:48 PM CET 2025: Completed iteration 197

=== Iteration 198/300 ===
Wed Nov 19 05:37:48 PM CET 2025: Starting company car negotiation iteration 198 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.67s (total since entry 12.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.62s (total since entry 4.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 198 completed successfully
Wed Nov 19 05:38:15 PM CET 2025: Completed iteration 198

=== Iteration 199/300 ===
Wed Nov 19 05:38:15 PM CET 2025: Starting company car negotiation iteration 199 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.94s (total since entry 15.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.40s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.25s (total since entry 4.66s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬37,250 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38839\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38839\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38839\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38839}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38839}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38839.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,839 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38510}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38510}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38510}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38510}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38510}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38510.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 199 completed successfully
Wed Nov 19 05:39:01 PM CET 2025: Completed iteration 199

=== Iteration 200/300 ===
Wed Nov 19 05:39:01 PM CET 2025: Starting company car negotiation iteration 200 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 16.90s (total since entry 17.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.65s (total since entry 7.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 200 completed successfully
Wed Nov 19 05:39:42 PM CET 2025: Completed iteration 200

=== Iteration 201/300 ===
Wed Nov 19 05:39:42 PM CET 2025: Starting company car negotiation iteration 201 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.02s (total since entry 13.59s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.77s (total since entry 4.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 201 completed successfully
Wed Nov 19 05:40:07 PM CET 2025: Completed iteration 201

=== Iteration 202/300 ===
Wed Nov 19 05:40:07 PM CET 2025: Starting company car negotiation iteration 202 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.62s (total since entry 13.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.71s (total since entry 4.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39100\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39100\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39100\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41500.0}
ğŸ’¡ Player model_a made offer â‚¬39,100 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬41,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 202 completed successfully
Wed Nov 19 05:40:40 PM CET 2025: Completed iteration 202

=== Iteration 203/300 ===
Wed Nov 19 05:40:40 PM CET 2025: Starting company car negotiation iteration 203 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.60s (total since entry 12.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.56s (total since entry 3.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 26500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 26500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 26500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 26500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 26500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 26500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬26,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
âœ… Player model_b accepted offer of â‚¬39,500 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 885.00 (saved â‚¬885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1085.00 (profit â‚¬1085.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41270.00, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=885.00, model_a surplus=1085.00
âœ… Calculated utility_surplus: {'model_a': 1085.0, 'model_b': 885.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41270.0, 'model_a': 39500.0}
Metrics: {'utility_surplus': {'model_a': 1085.0, 'model_b': 885.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 203 completed successfully
Wed Nov 19 05:41:06 PM CET 2025: Completed iteration 203

=== Iteration 204/300 ===
Wed Nov 19 05:41:06 PM CET 2025: Starting company car negotiation iteration 204 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.68s (total since entry 16.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.83s (total since entry 5.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38415}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38415}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38415}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38415}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38415}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38415.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,415 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38499\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38499\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38499\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,499 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 204 completed successfully
Wed Nov 19 05:41:40 PM CET 2025: Completed iteration 204

=== Iteration 205/300 ===
Wed Nov 19 05:41:40 PM CET 2025: Starting company car negotiation iteration 205 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.47s (total since entry 12.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.60s (total since entry 4.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬40,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=385.00, model_a surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 1585.0, 'model_b': 385.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 40770.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1585.0, 'model_b': 385.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 205 completed successfully
Wed Nov 19 05:42:07 PM CET 2025: Completed iteration 205

=== Iteration 206/300 ===
Wed Nov 19 05:42:07 PM CET 2025: Starting company car negotiation iteration 206 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.81s (total since entry 12.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 3.64s (total since entry 4.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 206 completed successfully
Wed Nov 19 05:42:41 PM CET 2025: Completed iteration 206

=== Iteration 207/300 ===
Wed Nov 19 05:42:41 PM CET 2025: Starting company car negotiation iteration 207 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.57s (total since entry 13.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 7.44s (total since entry 7.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬37,900 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 207 completed successfully
Wed Nov 19 05:43:23 PM CET 2025: Completed iteration 207

=== Iteration 208/300 ===
Wed Nov 19 05:43:23 PM CET 2025: Starting company car negotiation iteration 208 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.76s (total since entry 15.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.78s (total since entry 7.22s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40100\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40100\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40100\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40100.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,100 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37839}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37839}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37839}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37839}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37839}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37839.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,839 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38200}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38200}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38200}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38499}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38499}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38499}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38499}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38499}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38499.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,499 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 208 completed successfully
Wed Nov 19 05:43:58 PM CET 2025: Completed iteration 208

=== Iteration 209/300 ===
Wed Nov 19 05:43:58 PM CET 2025: Starting company car negotiation iteration 209 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.66s (total since entry 14.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.28s (total since entry 5.70s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 209 completed successfully
Wed Nov 19 05:44:23 PM CET 2025: Completed iteration 209

=== Iteration 210/300 ===
Wed Nov 19 05:44:23 PM CET 2025: Starting company car negotiation iteration 210 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.73s (total since entry 14.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.58s (total since entry 6.00s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39250}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39250}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39250}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,250 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-405.20, model_b surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38189.59715125, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 210 completed successfully
Wed Nov 19 05:44:58 PM CET 2025: Completed iteration 210

=== Iteration 211/300 ===
Wed Nov 19 05:44:58 PM CET 2025: Starting company car negotiation iteration 211 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.64s (total since entry 14.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.66s (total since entry 6.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.00, model_b surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42000.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 211 completed successfully
Wed Nov 19 05:45:27 PM CET 2025: Completed iteration 211

=== Iteration 212/300 ===
Wed Nov 19 05:45:27 PM CET 2025: Starting company car negotiation iteration 212 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.73s (total since entry 14.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.74s (total since entry 6.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2000.00, model_b surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 2000.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43000.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2000.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 212 completed successfully
Wed Nov 19 05:45:52 PM CET 2025: Completed iteration 212

=== Iteration 213/300 ===
Wed Nov 19 05:45:52 PM CET 2025: Starting company car negotiation iteration 213 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.13s (total since entry 15.69s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.88s (total since entry 7.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 213 completed successfully
Wed Nov 19 05:46:28 PM CET 2025: Completed iteration 213

=== Iteration 214/300 ===
Wed Nov 19 05:46:28 PM CET 2025: Starting company car negotiation iteration 214 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.86s (total since entry 14.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.88s (total since entry 6.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=385.00, model_a surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 1585.0, 'model_b': 385.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 40770.0, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1585.0, 'model_b': 385.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 214 completed successfully
Wed Nov 19 05:46:55 PM CET 2025: Completed iteration 214

=== Iteration 215/300 ===
Wed Nov 19 05:46:55 PM CET 2025: Starting company car negotiation iteration 215 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.16s (total since entry 14.72s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.66s (total since entry 6.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬40,385 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: -220.78 (saved â‚¬-220.78 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2161.22 (profit â‚¬2161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39558.45, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-220.78, model_a surplus=2161.22
âœ… Calculated utility_surplus: {'model_a': 2161.2249999999985, 'model_b': -220.77500000000146}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 39558.45, 'model_a': 40000.0}
Metrics: {'utility_surplus': {'model_a': 2161.2249999999985, 'model_b': -220.77500000000146}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 215 completed successfully
Wed Nov 19 05:47:23 PM CET 2025: Completed iteration 215

=== Iteration 216/300 ===
Wed Nov 19 05:47:23 PM CET 2025: Starting company car negotiation iteration 216 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.27s (total since entry 14.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.67s (total since entry 6.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 216 completed successfully
Wed Nov 19 05:48:00 PM CET 2025: Completed iteration 216

=== Iteration 217/300 ===
Wed Nov 19 05:48:00 PM CET 2025: Starting company car negotiation iteration 217 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.17s (total since entry 13.72s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.51s (total since entry 7.11s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.00, model_b surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42000.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 217 completed successfully
Wed Nov 19 05:48:29 PM CET 2025: Completed iteration 217

=== Iteration 218/300 ===
Wed Nov 19 05:48:29 PM CET 2025: Starting company car negotiation iteration 218 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.44s (total since entry 13.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.61s (total since entry 7.03s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39166}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39166}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39166}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39166}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39166}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39166.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,166 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-5.20, model_b surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38589.59715125, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 218 completed successfully
Wed Nov 19 05:49:10 PM CET 2025: Completed iteration 218

=== Iteration 219/300 ===
Wed Nov 19 05:49:10 PM CET 2025: Starting company car negotiation iteration 219 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.68s (total since entry 14.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.00s (total since entry 6.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 219 completed successfully
Wed Nov 19 05:49:44 PM CET 2025: Completed iteration 219

=== Iteration 220/300 ===
Wed Nov 19 05:49:44 PM CET 2025: Starting company car negotiation iteration 220 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.72s (total since entry 14.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.23s (total since entry 6.64s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬29,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 779.22 (saved â‚¬779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1161.22 (profit â‚¬1161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40558.45, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=779.22, model_a surplus=1161.22
âœ… Calculated utility_surplus: {'model_a': 1161.2249999999985, 'model_b': 779.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40558.45, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1161.2249999999985, 'model_b': 779.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 220 completed successfully
Wed Nov 19 05:50:15 PM CET 2025: Completed iteration 220

=== Iteration 221/300 ===
Wed Nov 19 05:50:15 PM CET 2025: Starting company car negotiation iteration 221 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.11s (total since entry 13.65s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.99s (total since entry 6.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬29,900 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37160}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37160}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37160}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37160}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37160}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37160.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,160 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38800\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38800\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38800\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,800 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,800 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38800
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 382.54 (saved â‚¬382.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1528.81 (profit â‚¬1528.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39565.07, seller=38800.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=382.54, model_a surplus=1528.81
âœ… Calculated utility_surplus: {'model_a': 1528.8066250000047, 'model_b': 382.53662499999336}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39565.07324999999, 'model_a': 38800.0}
Metrics: {'utility_surplus': {'model_a': 1528.8066250000047, 'model_b': 382.53662499999336}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 221 completed successfully
Wed Nov 19 05:50:48 PM CET 2025: Completed iteration 221

=== Iteration 222/300 ===
Wed Nov 19 05:50:48 PM CET 2025: Starting company car negotiation iteration 222 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.16s (total since entry 14.70s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.92s (total since entry 9.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 222 completed successfully
Wed Nov 19 05:51:20 PM CET 2025: Completed iteration 222

=== Iteration 223/300 ===
Wed Nov 19 05:51:20 PM CET 2025: Starting company car negotiation iteration 223 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.45s (total since entry 14.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.94s (total since entry 6.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,900 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-405.20, model_a surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38189.59715125, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 223 completed successfully
Wed Nov 19 05:51:55 PM CET 2025: Completed iteration 223

=== Iteration 224/300 ===
Wed Nov 19 05:51:55 PM CET 2025: Starting company car negotiation iteration 224 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.44s (total since entry 16.01s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.76s (total since entry 10.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40100\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40100\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40100\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40100.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,100 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬38,750 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38750
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 432.54 (saved â‚¬432.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1478.81 (profit â‚¬1478.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39615.07, seller=38750.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=432.54, model_b surplus=1478.81
âœ… Calculated utility_surplus: {'model_a': 432.53662499999336, 'model_b': 1478.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39615.07324999999, 'model_b': 38750.0}
Metrics: {'utility_surplus': {'model_a': 432.53662499999336, 'model_b': 1478.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 224 completed successfully
Wed Nov 19 05:52:32 PM CET 2025: Completed iteration 224

=== Iteration 225/300 ===
Wed Nov 19 05:52:32 PM CET 2025: Starting company car negotiation iteration 225 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.24s (total since entry 13.81s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.53s (total since entry 6.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-5.20, model_b surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38589.59715125, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 225 completed successfully
Wed Nov 19 05:53:08 PM CET 2025: Completed iteration 225

=== Iteration 226/300 ===
Wed Nov 19 05:53:08 PM CET 2025: Starting company car negotiation iteration 226 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.64s (total since entry 14.18s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.67s (total since entry 6.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,700 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 226 completed successfully
Wed Nov 19 05:53:43 PM CET 2025: Completed iteration 226

=== Iteration 227/300 ===
Wed Nov 19 05:53:43 PM CET 2025: Starting company car negotiation iteration 227 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.27s (total since entry 13.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 7.65s (total since entry 8.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38800\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38800\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38800\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,800 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 582.54 (saved â‚¬582.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1328.81 (profit â‚¬1328.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39765.07, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=582.54, model_b surplus=1328.81
âœ… Calculated utility_surplus: {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39765.07324999999, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 227 completed successfully
Wed Nov 19 05:54:16 PM CET 2025: Completed iteration 227

=== Iteration 228/300 ===
Wed Nov 19 05:54:16 PM CET 2025: Starting company car negotiation iteration 228 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.99s (total since entry 13.55s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.45s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.02s (total since entry 6.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 228 completed successfully
Wed Nov 19 05:54:54 PM CET 2025: Completed iteration 228

=== Iteration 229/300 ===
Wed Nov 19 05:54:54 PM CET 2025: Starting company car negotiation iteration 229 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 16.39s (total since entry 16.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.27s (total since entry 9.70s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37839}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37839}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37839}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37839}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37839}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37839.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬37,839 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38525}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38525}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38525}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38525}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38525}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38525.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,525 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,525 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=38525
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 69.80 (saved â‚¬69.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1812.87 (profit â‚¬1812.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38664.60, seller=38525.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=69.80, model_b surplus=1812.87
âœ… Calculated utility_surplus: {'model_a': 69.7985756249982, 'model_b': 1812.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38664.59715125, 'model_b': 38525.0}
Metrics: {'utility_surplus': {'model_a': 69.7985756249982, 'model_b': 1812.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 229 completed successfully
Wed Nov 19 05:55:31 PM CET 2025: Completed iteration 229

=== Iteration 230/300 ===
Wed Nov 19 05:55:31 PM CET 2025: Starting company car negotiation iteration 230 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.59s (total since entry 13.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.74s (total since entry 9.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 230 completed successfully
Wed Nov 19 05:56:02 PM CET 2025: Completed iteration 230

=== Iteration 231/300 ===
Wed Nov 19 05:56:02 PM CET 2025: Starting company car negotiation iteration 231 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 16.83s (total since entry 17.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.46s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.50s (total since entry 9.97s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39250\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39250\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39250\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,250 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 36000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 36000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 36000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 36000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 36000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 36000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬36,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 594.80 (saved â‚¬594.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1287.87 (profit â‚¬1287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39189.60, seller=38000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=594.80, model_a surplus=1287.87
âœ… Calculated utility_surplus: {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39189.59715125, 'model_a': 38000.0}
Metrics: {'utility_surplus': {'model_a': 1287.8745256249967, 'model_b': 594.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 231 completed successfully
Wed Nov 19 05:56:43 PM CET 2025: Completed iteration 231

=== Iteration 232/300 ===
Wed Nov 19 05:56:43 PM CET 2025: Starting company car negotiation iteration 232 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.74s (total since entry 7.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40190\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40190\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40190\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40190}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40190}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40190.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,190 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 582.54 (saved â‚¬582.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1328.81 (profit â‚¬1328.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39765.07, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=582.54, model_b surplus=1328.81
âœ… Calculated utility_surplus: {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39765.07324999999, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 232 completed successfully
Wed Nov 19 05:57:15 PM CET 2025: Completed iteration 232

=== Iteration 233/300 ===
Wed Nov 19 05:57:15 PM CET 2025: Starting company car negotiation iteration 233 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.38s (total since entry 14.93s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.59s (total since entry 9.02s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29700.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬29,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,385 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 233 completed successfully
Wed Nov 19 05:57:53 PM CET 2025: Completed iteration 233

=== Iteration 234/300 ===
Wed Nov 19 05:57:53 PM CET 2025: Starting company car negotiation iteration 234 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.42s (total since entry 14.97s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.42s (total since entry 6.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
âœ… Player model_b accepted offer of â‚¬39,500 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 885.00 (saved â‚¬885.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1085.00 (profit â‚¬1085.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41270.00, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=885.00, model_b surplus=1085.00
âœ… Calculated utility_surplus: {'model_a': 885.0, 'model_b': 1085.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41270.0, 'model_b': 39500.0}
Metrics: {'utility_surplus': {'model_a': 885.0, 'model_b': 1085.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 234 completed successfully
Wed Nov 19 05:58:26 PM CET 2025: Completed iteration 234

=== Iteration 235/300 ===
Wed Nov 19 05:58:26 PM CET 2025: Starting company car negotiation iteration 235 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.66s (total since entry 14.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.88s (total since entry 6.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 235 completed successfully
Wed Nov 19 05:58:51 PM CET 2025: Completed iteration 235

=== Iteration 236/300 ===
Wed Nov 19 05:58:51 PM CET 2025: Starting company car negotiation iteration 236 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.96s (total since entry 12.51s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.25s (total since entry 5.68s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=385.00, model_b surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 385.0, 'model_b': 1585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 40770.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 385.0, 'model_b': 1585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 236 completed successfully
Wed Nov 19 05:59:15 PM CET 2025: Completed iteration 236

=== Iteration 237/300 ===
Wed Nov 19 05:59:15 PM CET 2025: Starting company car negotiation iteration 237 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.41s (total since entry 14.95s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.54s (total since entry 7.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,500 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 279.22 (saved â‚¬279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1661.22 (profit â‚¬1661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40058.45, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=279.22, model_a surplus=1661.22
âœ… Calculated utility_surplus: {'model_a': 1661.2249999999985, 'model_b': 279.22499999999854}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40058.45, 'model_a': 39500.0}
Metrics: {'utility_surplus': {'model_a': 1661.2249999999985, 'model_b': 279.22499999999854}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 237 completed successfully
Wed Nov 19 05:59:48 PM CET 2025: Completed iteration 237

=== Iteration 238/300 ===
Wed Nov 19 05:59:48 PM CET 2025: Starting company car negotiation iteration 238 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.37s (total since entry 14.94s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.91s (total since entry 7.34s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 238 completed successfully
Wed Nov 19 06:00:20 PM CET 2025: Completed iteration 238

=== Iteration 239/300 ===
Wed Nov 19 06:00:20 PM CET 2025: Starting company car negotiation iteration 239 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.79s (total since entry 14.35s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 9.28s (total since entry 9.71s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,385 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 779.22 (saved â‚¬779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1161.22 (profit â‚¬1161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40558.45, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=779.22, model_a surplus=1161.22
âœ… Calculated utility_surplus: {'model_a': 1161.2249999999985, 'model_b': 779.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40558.45, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1161.2249999999985, 'model_b': 779.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 239 completed successfully
Wed Nov 19 06:00:52 PM CET 2025: Completed iteration 239

=== Iteration 240/300 ===
Wed Nov 19 06:00:52 PM CET 2025: Starting company car negotiation iteration 240 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.85s (total since entry 13.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.01s (total since entry 6.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 240 completed successfully
Wed Nov 19 06:01:17 PM CET 2025: Completed iteration 240

=== Iteration 241/300 ===
Wed Nov 19 06:01:17 PM CET 2025: Starting company car negotiation iteration 241 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.11s (total since entry 13.67s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.86s (total since entry 6.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 241 completed successfully
Wed Nov 19 06:01:51 PM CET 2025: Completed iteration 241

=== Iteration 242/300 ===
Wed Nov 19 06:01:51 PM CET 2025: Starting company car negotiation iteration 242 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.77s (total since entry 14.34s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.56s (total since entry 6.97s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.00, model_b surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42000.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 242 completed successfully
Wed Nov 19 06:02:20 PM CET 2025: Completed iteration 242

=== Iteration 243/300 ===
Wed Nov 19 06:02:20 PM CET 2025: Starting company car negotiation iteration 243 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.24s (total since entry 13.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.55s (total since entry 6.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29999.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬29,999 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37885}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37885}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37885}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37885}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37885}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37885.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,885 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37886}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37886}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37886}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37886}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37886}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37886.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,886 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬37,200 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 243 completed successfully
Wed Nov 19 06:02:59 PM CET 2025: Completed iteration 243

=== Iteration 244/300 ===
Wed Nov 19 06:02:59 PM CET 2025: Starting company car negotiation iteration 244 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.58s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.82s (total since entry 15.42s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.57s (total since entry 7.00s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39700\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39700\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39700\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39700.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,700 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 582.54 (saved â‚¬582.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1328.81 (profit â‚¬1328.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39765.07, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=582.54, model_b surplus=1328.81
âœ… Calculated utility_surplus: {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39765.07324999999, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 244 completed successfully
Wed Nov 19 06:03:34 PM CET 2025: Completed iteration 244

=== Iteration 245/300 ===
Wed Nov 19 06:03:34 PM CET 2025: Starting company car negotiation iteration 245 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.65s (total since entry 16.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.97s (total since entry 6.39s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬29,900 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39250\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39250\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39250\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,250 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬39,250 (made in round 3)
ğŸ” [BATNA DEBUG] Round 3: price=39250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 529.22 (saved â‚¬529.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1411.22 (profit â‚¬1411.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40308.45, seller=39250.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=529.22, model_a surplus=1411.22
âœ… Calculated utility_surplus: {'model_a': 1411.2249999999985, 'model_b': 529.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 40308.45, 'model_a': 39250.0}
Metrics: {'utility_surplus': {'model_a': 1411.2249999999985, 'model_b': 529.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 245 completed successfully
Wed Nov 19 06:04:08 PM CET 2025: Completed iteration 245

=== Iteration 246/300 ===
Wed Nov 19 06:04:08 PM CET 2025: Starting company car negotiation iteration 246 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.58s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.10s (total since entry 13.70s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.53s (total since entry 8.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,999 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1385.00, model_a surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 585.0, 'model_b': 1385.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 41770.0, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 585.0, 'model_b': 1385.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 246 completed successfully
Wed Nov 19 06:04:41 PM CET 2025: Completed iteration 246

=== Iteration 247/300 ===
Wed Nov 19 06:04:41 PM CET 2025: Starting company car negotiation iteration 247 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.58s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.54s (total since entry 15.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.85s (total since entry 6.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 247 completed successfully
Wed Nov 19 06:05:10 PM CET 2025: Completed iteration 247

=== Iteration 248/300 ===
Wed Nov 19 06:05:10 PM CET 2025: Starting company car negotiation iteration 248 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 12.73s (total since entry 13.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.97s (total since entry 6.39s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 27000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 27000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 27000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 27000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬27,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 248 completed successfully
Wed Nov 19 06:05:41 PM CET 2025: Completed iteration 248

=== Iteration 249/300 ===
Wed Nov 19 06:05:41 PM CET 2025: Starting company car negotiation iteration 249 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.88s (total since entry 15.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.88s (total since entry 7.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 779.22 (saved â‚¬779.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1161.22 (profit â‚¬1161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40558.45, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=779.22, model_b surplus=1161.22
âœ… Calculated utility_surplus: {'model_a': 779.2249999999985, 'model_b': 1161.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 40558.45, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 779.2249999999985, 'model_b': 1161.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 249 completed successfully
Wed Nov 19 06:06:11 PM CET 2025: Completed iteration 249

=== Iteration 250/300 ===
Wed Nov 19 06:06:11 PM CET 2025: Starting company car negotiation iteration 250 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.23s (total since entry 14.80s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.76s (total since entry 7.20s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39200\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39200\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39200\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39200.0}
ğŸ’¡ Player model_b made offer â‚¬29,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-405.20, model_a surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38189.59715125, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2287.8745256249967, 'model_b': -405.2014243750018}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 250 completed successfully
Wed Nov 19 06:06:52 PM CET 2025: Completed iteration 250

=== Iteration 251/300 ===
Wed Nov 19 06:06:52 PM CET 2025: Starting company car negotiation iteration 251 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.72s (total since entry 15.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.02s (total since entry 6.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬42,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 251 completed successfully
Wed Nov 19 06:07:22 PM CET 2025: Completed iteration 251

=== Iteration 252/300 ===
Wed Nov 19 06:07:22 PM CET 2025: Starting company car negotiation iteration 252 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.23s (total since entry 15.79s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.64s (total since entry 6.07s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38250\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38250\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38250\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,250 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,250 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38250
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 344.80 (saved â‚¬344.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1537.87 (profit â‚¬1537.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38939.60, seller=38250.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=344.80, model_b surplus=1537.87
âœ… Calculated utility_surplus: {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38939.59715125, 'model_b': 38250.0}
Metrics: {'utility_surplus': {'model_a': 344.7985756249982, 'model_b': 1537.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 252 completed successfully
Wed Nov 19 06:08:02 PM CET 2025: Completed iteration 252

=== Iteration 253/300 ===
Wed Nov 19 06:08:02 PM CET 2025: Starting company car negotiation iteration 253 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.06s (total since entry 13.62s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.36s (total since entry 6.79s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬40,500 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬40,500 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=40500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 500.00 (saved â‚¬500.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1500.00 (profit â‚¬1500.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41500.00, seller=40500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=500.00, model_b surplus=1500.00
âœ… Calculated utility_surplus: {'model_a': 500.0, 'model_b': 1500.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 41500.0, 'model_b': 40500.0}
Metrics: {'utility_surplus': {'model_a': 500.0, 'model_b': 1500.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 253 completed successfully
Wed Nov 19 06:08:30 PM CET 2025: Completed iteration 253

=== Iteration 254/300 ===
Wed Nov 19 06:08:30 PM CET 2025: Starting company car negotiation iteration 254 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.23s (total since entry 14.77s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.91s (total since entry 7.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38650\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38650\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38650\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38650}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38650}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38650.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_a made offer â‚¬38,650 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38550}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38550}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38550}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38550}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38550}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38550.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,550 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1094.80, model_a surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39689.59715125, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 254 completed successfully
Wed Nov 19 06:09:09 PM CET 2025: Completed iteration 254

=== Iteration 255/300 ===
Wed Nov 19 06:09:09 PM CET 2025: Starting company car negotiation iteration 255 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.59s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 16.46s (total since entry 17.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 7.89s (total since entry 8.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37839}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37839}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37839}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37839}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37839}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37839.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬37,839 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38450}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38450}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38450}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 255 completed successfully
Wed Nov 19 06:09:50 PM CET 2025: Completed iteration 255

=== Iteration 256/300 ===
Wed Nov 19 06:09:50 PM CET 2025: Starting company car negotiation iteration 256 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.73s (total since entry 14.27s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.47s (total since entry 5.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬29,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬37,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=37500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1094.80 (saved â‚¬1094.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 787.87 (profit â‚¬787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39689.60, seller=37500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1094.80, model_a surplus=787.87
âœ… Calculated utility_surplus: {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 39689.59715125, 'model_a': 37500.0}
Metrics: {'utility_surplus': {'model_a': 787.8745256249967, 'model_b': 1094.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 256 completed successfully
Wed Nov 19 06:10:22 PM CET 2025: Completed iteration 256

=== Iteration 257/300 ===
Wed Nov 19 06:10:22 PM CET 2025: Starting company car negotiation iteration 257 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.47s (total since entry 14.04s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.89s (total since entry 6.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=385.00, model_b surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 385.0, 'model_b': 1585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 40770.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 385.0, 'model_b': 1585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 257 completed successfully
Wed Nov 19 06:10:49 PM CET 2025: Completed iteration 257

=== Iteration 258/300 ===
Wed Nov 19 06:10:49 PM CET 2025: Starting company car negotiation iteration 258 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.52s (total since entry 14.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.04s (total since entry 6.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -405.20 (saved â‚¬-405.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2287.87 (profit â‚¬2287.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38189.60, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-405.20, model_b surplus=2287.87
âœ… Calculated utility_surplus: {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38189.59715125, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': -405.2014243750018, 'model_b': 2287.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 258 completed successfully
Wed Nov 19 06:11:24 PM CET 2025: Completed iteration 258

=== Iteration 259/300 ===
Wed Nov 19 06:11:24 PM CET 2025: Starting company car negotiation iteration 259 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.04s (total since entry 13.60s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.99s (total since entry 6.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38200\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38200\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38200}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38200.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬38,200 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 259 completed successfully
Wed Nov 19 06:11:56 PM CET 2025: Completed iteration 259

=== Iteration 260/300 ===
Wed Nov 19 06:11:56 PM CET 2025: Starting company car negotiation iteration 260 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.54s (total since entry 14.09s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.81s (total since entry 7.23s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38625\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38625\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38625\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38625}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38625}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38625.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_a made offer â‚¬38,625 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "reject"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "reject"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "reject"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'reject'}
[DEBUG] Parsed JSON: {'type': 'reject'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'reject'}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âŒ Player model_a rejected after reaching proposal limit (4/4)
ğŸ² [ROLE DEBUG] No Agreement - Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a utility=0, model_b utility=0
âœ… Calculated utility_surplus: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 0.0, 'model_b': 0.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 0.0}
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: False
Metrics: {'utility_surplus': {'model_a': 0.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 0.0, 'model_b': 0.0}, 'feasibility': {'model_a': 0.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 260 completed successfully
Wed Nov 19 06:12:29 PM CET 2025: Completed iteration 260

=== Iteration 261/300 ===
Wed Nov 19 06:12:29 PM CET 2025: Starting company car negotiation iteration 261 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 18.58s (total since entry 19.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.94s (total since entry 7.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬42,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37999.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬37,999 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
âš ï¸ Player model_b tried to make offer but exceeded proposal limit (4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 261 completed successfully
Wed Nov 19 06:13:08 PM CET 2025: Completed iteration 261

=== Iteration 262/300 ===
Wed Nov 19 06:13:08 PM CET 2025: Starting company car negotiation iteration 262 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.75s (total since entry 15.30s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.22s (total since entry 6.64s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40200}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40200}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40200}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40200}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40200}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40200.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬40,200 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1615.00 (saved â‚¬-1615.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3585.00 (profit â‚¬3585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38770.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1615.00, model_a surplus=3585.00
âœ… Calculated utility_surplus: {'model_a': 3585.0, 'model_b': -1615.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_b': 38770.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3585.0, 'model_b': -1615.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 262 completed successfully
Wed Nov 19 06:13:41 PM CET 2025: Completed iteration 262

=== Iteration 263/300 ===
Wed Nov 19 06:13:41 PM CET 2025: Starting company car negotiation iteration 263 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.58s (total since entry 16.32s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.57s (total since entry 6.99s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1000.00 (saved â‚¬1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1000.00 (profit â‚¬1000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=42000.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1000.00, model_b surplus=1000.00
âœ… Calculated utility_surplus: {'model_a': 1000.0, 'model_b': 1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 42000.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 1000.0, 'model_b': 1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 263 completed successfully
Wed Nov 19 06:14:10 PM CET 2025: Completed iteration 263

=== Iteration 264/300 ===
Wed Nov 19 06:14:10 PM CET 2025: Starting company car negotiation iteration 264 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 18.59s (total since entry 19.15s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.68s (total since entry 7.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38900\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38900\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38900\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38900.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,900 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 582.54 (saved â‚¬582.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1328.81 (profit â‚¬1328.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39765.07, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=582.54, model_b surplus=1328.81
âœ… Calculated utility_surplus: {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39765.07324999999, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': 582.5366249999934, 'model_b': 1328.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 264 completed successfully
Wed Nov 19 06:14:49 PM CET 2025: Completed iteration 264

=== Iteration 265/300 ===
Wed Nov 19 06:14:49 PM CET 2025: Starting company car negotiation iteration 265 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.42s (total since entry 13.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.86s (total since entry 6.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38999}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38999}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38999}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38999}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38999.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,999 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38760}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38760}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38760}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38760}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38760}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38760.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,760 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38595}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38595}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38595}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38595}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38595}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38595.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,595 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,595 (made in round 5)
ğŸ” [BATNA DEBUG] Round 5: price=38595
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -0.20 (saved â‚¬-0.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1882.87 (profit â‚¬1882.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38594.60, seller=38595.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-0.20, model_b surplus=1882.87
âœ… Calculated utility_surplus: {'model_a': -0.20142437500180677, 'model_b': 1882.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 75.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38594.59715125, 'model_b': 38595.0}
Metrics: {'utility_surplus': {'model_a': -0.20142437500180677, 'model_b': 1882.8745256249967}, 'risk_minimization': {'model_a': 75.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 265 completed successfully
Wed Nov 19 06:15:20 PM CET 2025: Completed iteration 265

=== Iteration 266/300 ===
Wed Nov 19 06:15:20 PM CET 2025: Starting company car negotiation iteration 266 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.34s (total since entry 13.89s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.85s (total since entry 6.28s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 266 completed successfully
Wed Nov 19 06:15:54 PM CET 2025: Completed iteration 266

=== Iteration 267/300 ===
Wed Nov 19 06:15:54 PM CET 2025: Starting company car negotiation iteration 267 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.20s (total since entry 13.75s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.68s (total since entry 7.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
1, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬37,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 582.54 (saved â‚¬582.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1328.81 (profit â‚¬1328.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39765.07, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=582.54, model_a surplus=1328.81
âœ… Calculated utility_surplus: {'model_a': 1328.8066250000047, 'model_b': 582.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39765.07324999999, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1328.8066250000047, 'model_b': 582.5366249999934}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 267 completed successfully
Wed Nov 19 06:16:27 PM CET 2025: Completed iteration 267

=== Iteration 268/300 ===
Wed Nov 19 06:16:27 PM CET 2025: Starting company car negotiation iteration 268 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.05s (total since entry 13.60s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.40s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.00s (total since entry 6.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1279.22, model_b surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 41058.45, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1279.2249999999985, 'model_b': 661.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 268 completed successfully
Wed Nov 19 06:16:58 PM CET 2025: Completed iteration 268

=== Iteration 269/300 ===
Wed Nov 19 06:16:58 PM CET 2025: Starting company car negotiation iteration 269 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.06s (total since entry 13.62s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.00s (total since entry 6.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 269 completed successfully
Wed Nov 19 06:17:28 PM CET 2025: Completed iteration 269

=== Iteration 270/300 ===
Wed Nov 19 06:17:28 PM CET 2025: Starting company car negotiation iteration 270 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.24s (total since entry 13.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.72s (total since entry 7.14s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 26900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 26900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 26900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 26900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 26900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 26900.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬26,900 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,385 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38800\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38800\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38800\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,800 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 270 completed successfully
Wed Nov 19 06:18:05 PM CET 2025: Completed iteration 270

=== Iteration 271/300 ===
Wed Nov 19 06:18:05 PM CET 2025: Starting company car negotiation iteration 271 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 20.97s (total since entry 21.53s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 8.70s (total since entry 9.13s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 2: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 385.00 (saved â‚¬385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1585.00 (profit â‚¬1585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40770.00, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=385.00, model_b surplus=1585.00
âœ… Calculated utility_surplus: {'model_a': 385.0, 'model_b': 1585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 40770.0, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': 385.0, 'model_b': 1585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 271 completed successfully
Wed Nov 19 06:18:43 PM CET 2025: Completed iteration 271

=== Iteration 272/300 ===
Wed Nov 19 06:18:43 PM CET 2025: Starting company car negotiation iteration 272 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.54s (total since entry 16.08s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.99s (total since entry 7.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬39,000 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 182.54 (saved â‚¬182.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1728.81 (profit â‚¬1728.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39365.07, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=182.54, model_a surplus=1728.81
âœ… Calculated utility_surplus: {'model_a': 1728.8066250000047, 'model_b': 182.53662499999336}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39365.07324999999, 'model_a': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1728.8066250000047, 'model_b': 182.53662499999336}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 272 completed successfully
Wed Nov 19 06:19:20 PM CET 2025: Completed iteration 272

=== Iteration 273/300 ===
Wed Nov 19 06:19:20 PM CET 2025: Starting company car negotiation iteration 273 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.41s (total since entry 14.96s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.89s (total since entry 7.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 273 completed successfully
Wed Nov 19 06:19:54 PM CET 2025: Completed iteration 273

=== Iteration 274/300 ===
Wed Nov 19 06:19:54 PM CET 2025: Starting company car negotiation iteration 274 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.80s (total since entry 14.34s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.70s (total since entry 6.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
2, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2000.00, model_b surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 2000.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43000.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2000.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 274 completed successfully
Wed Nov 19 06:20:21 PM CET 2025: Completed iteration 274

=== Iteration 275/300 ===
Wed Nov 19 06:20:21 PM CET 2025: Starting company car negotiation iteration 275 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.62s (total since entry 14.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.97s (total since entry 6.41s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 20000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 20000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 20000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 20000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 20000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 20000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬20,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39600.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38888\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38888\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38888\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38888}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38888}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38888.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,888 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-5.20, model_b surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38589.59715125, 'model_b': 38600.0}
Metrics: {'utility_surplus': {'model_a': -5.201424375001807, 'model_b': 1887.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 275 completed successfully
Wed Nov 19 06:20:59 PM CET 2025: Completed iteration 275

=== Iteration 276/300 ===
Wed Nov 19 06:20:59 PM CET 2025: Starting company car negotiation iteration 276 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.77s (total since entry 14.35s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.95s (total since entry 6.38s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 276 completed successfully
Wed Nov 19 06:21:36 PM CET 2025: Completed iteration 276

=== Iteration 277/300 ===
Wed Nov 19 06:21:36 PM CET 2025: Starting company car negotiation iteration 277 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 13.38s (total since entry 13.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.96s (total since entry 6.37s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬29,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,385 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39600.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 277 completed successfully
Wed Nov 19 06:22:13 PM CET 2025: Completed iteration 277

=== Iteration 278/300 ===
Wed Nov 19 06:22:13 PM CET 2025: Starting company car negotiation iteration 278 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.80s (total since entry 15.35s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.63s (total since entry 7.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39250\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39250\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39250\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬39,250 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 278 completed successfully
Wed Nov 19 06:22:49 PM CET 2025: Completed iteration 278

=== Iteration 279/300 ===
Wed Nov 19 06:22:49 PM CET 2025: Starting company car negotiation iteration 279 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.77s (total since entry 16.33s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.74s (total since entry 7.16s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,700 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=682.54, model_b surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39865.07324999999, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 682.5366249999934, 'model_b': 1228.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 279 completed successfully
Wed Nov 19 06:23:25 PM CET 2025: Completed iteration 279

=== Iteration 280/300 ===
Wed Nov 19 06:23:25 PM CET 2025: Starting company car negotiation iteration 280 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 15.14s (total since entry 15.69s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.17s (total since entry 6.59s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 280 completed successfully
Wed Nov 19 06:24:03 PM CET 2025: Completed iteration 280

=== Iteration 281/300 ===
Wed Nov 19 06:24:03 PM CET 2025: Starting company car negotiation iteration 281 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 14.85s (total since entry 15.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 6.35s (total since entry 6.77s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38400}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38400}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38400}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 281 completed successfully
Wed Nov 19 06:24:39 PM CET 2025: Completed iteration 281

=== Iteration 282/300 ===
Wed Nov 19 06:24:39 PM CET 2025: Starting company car negotiation iteration 282 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 10.80s (total since entry 11.37s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.78s (total since entry 5.21s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37619}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37619}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37619}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37619}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37619}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37619.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬37,619 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37900}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37900}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37900}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37900}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37900.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,900 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38600\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38600\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,600 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38600
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: -5.20 (saved â‚¬-5.20 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1887.87 (profit â‚¬1887.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38589.60, seller=38600.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-5.20, model_a surplus=1887.87
âœ… Calculated utility_surplus: {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38589.59715125, 'model_a': 38600.0}
Metrics: {'utility_surplus': {'model_a': 1887.8745256249967, 'model_b': -5.201424375001807}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 282 completed successfully
Wed Nov 19 06:25:08 PM CET 2025: Completed iteration 282

=== Iteration 283/300 ===
Wed Nov 19 06:25:08 PM CET 2025: Starting company car negotiation iteration 283 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.06s (total since entry 11.63s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.95s (total since entry 5.37s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬42,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 283 completed successfully
Wed Nov 19 06:25:31 PM CET 2025: Completed iteration 283

=== Iteration 284/300 ===
Wed Nov 19 06:25:31 PM CET 2025: Starting company car negotiation iteration 284 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.35s (total since entry 11.90s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.49s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.94s (total since entry 5.43s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 3/4)
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 732.54 (saved â‚¬732.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1178.81 (profit â‚¬1178.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39915.07, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=732.54, model_b surplus=1178.81
âœ… Calculated utility_surplus: {'model_a': 732.5366249999934, 'model_b': 1178.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39915.07324999999, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 732.5366249999934, 'model_b': 1178.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 284 completed successfully
Wed Nov 19 06:25:59 PM CET 2025: Completed iteration 284

=== Iteration 285/300 ===
Wed Nov 19 06:25:59 PM CET 2025: Starting company car negotiation iteration 285 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.38s (total since entry 11.92s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.90s (total since entry 5.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
15, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29999}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29999}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29999}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29999}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29999}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29999.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬29,999 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 37500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 37500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 37500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41667}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41667}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41667}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41667}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41667}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41667.0}
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬41,667 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬39,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 285 completed successfully
Wed Nov 19 06:26:28 PM CET 2025: Completed iteration 285

=== Iteration 286/300 ===
Wed Nov 19 06:26:28 PM CET 2025: Starting company car negotiation iteration 286 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.55s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.15s (total since entry 11.71s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.83s (total since entry 5.26s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 27000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 27000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 27000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 27000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 27000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 27000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬27,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40385}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40385}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40385}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40385}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40385}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40385.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬40,385 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39162}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39162}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39162}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39162}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39162}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39162.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38800\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38800\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38800\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38800}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38800}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38800.0}
ğŸ’¡ Player model_b made offer â‚¬39,162 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,800 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 286 completed successfully
Wed Nov 19 06:26:55 PM CET 2025: Completed iteration 286

=== Iteration 287/300 ===
Wed Nov 19 06:26:55 PM CET 2025: Starting company car negotiation iteration 287 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.60s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.21s (total since entry 11.82s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.01s (total since entry 5.44s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 39750\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 39750\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 39750\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬39,500 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=39500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: -317.46 (saved â‚¬-317.46 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2228.81 (profit â‚¬2228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38865.07, seller=39500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-317.46, model_a surplus=2228.81
âœ… Calculated utility_surplus: {'model_a': 2228.8066250000047, 'model_b': -317.46337500000664}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 38865.07324999999, 'model_a': 39500.0}
Metrics: {'utility_surplus': {'model_a': 2228.8066250000047, 'model_b': -317.46337500000664}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 287 completed successfully
Wed Nov 19 06:27:24 PM CET 2025: Completed iteration 287

=== Iteration 288/300 ===
Wed Nov 19 06:27:24 PM CET 2025: Starting company car negotiation iteration 288 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.42s (total since entry 11.97s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.02s (total since entry 5.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 29700}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 29700}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 29700}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 29700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 29700}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 29700.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬29,700 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39250\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39250\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39250\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39250}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39250}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39250.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,250 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 4/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 4: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 682.54 (saved â‚¬682.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1228.81 (profit â‚¬1228.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39865.07, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=682.54, model_a surplus=1228.81
âœ… Calculated utility_surplus: {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_b': 39865.07324999999, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1228.8066250000047, 'model_b': 682.5366249999934}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 288 completed successfully
Wed Nov 19 06:27:54 PM CET 2025: Completed iteration 288

=== Iteration 289/300 ===
Wed Nov 19 06:27:54 PM CET 2025: Starting company car negotiation iteration 289 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.17s (total since entry 11.72s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.88s (total since entry 5.31s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
8, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 2: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=40385.00, seller=38415.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1385.00 (saved â‚¬1385.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 585.00 (profit â‚¬585.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41770.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=1385.00, model_b surplus=585.00
âœ… Calculated utility_surplus: {'model_a': 1385.0, 'model_b': 585.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 2
Final utilities: {'model_a': 41770.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 1385.0, 'model_b': 585.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 289 completed successfully
Wed Nov 19 06:28:20 PM CET 2025: Completed iteration 289

=== Iteration 290/300 ===
Wed Nov 19 06:28:20 PM CET 2025: Starting company car negotiation iteration 290 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.58s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.24s (total since entry 11.84s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.95s (total since entry 5.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 290 completed successfully
Wed Nov 19 06:28:52 PM CET 2025: Completed iteration 290

=== Iteration 291/300 ===
Wed Nov 19 06:28:52 PM CET 2025: Starting company car negotiation iteration 291 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.56s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.26s (total since entry 11.83s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.93s (total since entry 5.36s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
5, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38700\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38700\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38700\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38700}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38700}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38700.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,700 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38525}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38525}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38525}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38525}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38525}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38525.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬38,525 (proposal 4/4)
âœ… Player model_b accepted offer of â‚¬38,525 (made in round 4)
ğŸ” [BATNA DEBUG] Round 4: price=38525
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 657.54 (saved â‚¬657.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1253.81 (profit â‚¬1253.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39840.07, seller=38525.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=657.54, model_b surplus=1253.81
âœ… Calculated utility_surplus: {'model_a': 657.5366249999934, 'model_b': 1253.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 66.66666666666666}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39840.07324999999, 'model_b': 38525.0}
Metrics: {'utility_surplus': {'model_a': 657.5366249999934, 'model_b': 1253.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 66.66666666666666}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 291 completed successfully
Wed Nov 19 06:29:18 PM CET 2025: Completed iteration 291

=== Iteration 292/300 ===
Wed Nov 19 06:29:18 PM CET 2025: Starting company car negotiation iteration 292 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.70s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.57s (total since entry 12.29s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.02s (total since entry 5.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_b made offer â‚¬38,600 (proposal 2/4)
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38450\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38450\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38450}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38450}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38450.0}
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,450 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,450 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38450
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 144.80 (saved â‚¬144.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1737.87 (profit â‚¬1737.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38739.60, seller=38450.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=144.80, model_b surplus=1737.87
âœ… Calculated utility_surplus: {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 75.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38739.59715125, 'model_b': 38450.0}
Metrics: {'utility_surplus': {'model_a': 144.7985756249982, 'model_b': 1737.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 75.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 292 completed successfully
Wed Nov 19 06:29:48 PM CET 2025: Completed iteration 292

=== Iteration 293/300 ===
Wed Nov 19 06:29:48 PM CET 2025: Starting company car negotiation iteration 293 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.50s (total since entry 12.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.13s (total since entry 5.54s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 42000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 42000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 42000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬42,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬42,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 293 completed successfully
Wed Nov 19 06:30:14 PM CET 2025: Completed iteration 293

=== Iteration 294/300 ===
Wed Nov 19 06:30:14 PM CET 2025: Starting company car negotiation iteration 294 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.44s (total since entry 11.98s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.06s (total since entry 5.48s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 25000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 25000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 25000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 25000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 25000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 25000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬25,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37500}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 37500}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 37500}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 37500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 37500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬37,500 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37600}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37600}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37600}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37600}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38100\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38100\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38100\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38100}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38100}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38100.0}
ğŸ’¡ Player model_b made offer â‚¬37,600 (proposal 3/4)
ğŸ’¡ Player model_a made offer â‚¬38,100 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 38000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 38000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ’¡ Player model_a made offer â‚¬38,000 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=94.80, model_b surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 50.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_a': 38689.59715125, 'model_b': 38500.0}
Metrics: {'utility_surplus': {'model_a': 94.7985756249982, 'model_b': 1787.8745256249967}, 'risk_minimization': {'model_a': 100.0, 'model_b': 50.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 294 completed successfully
Wed Nov 19 06:30:46 PM CET 2025: Completed iteration 294

=== Iteration 295/300 ===
Wed Nov 19 06:30:46 PM CET 2025: Starting company car negotiation iteration 295 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.61s (total since entry 12.17s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.03s (total since entry 5.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âš ï¸ Player model_b tried to accept but no offer exists
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬40,000 (made in round 2)
ğŸ” [BATNA DEBUG] Round 3: price=40000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: -220.78 (saved â‚¬-220.78 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 2161.22 (profit â‚¬2161.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39558.45, seller=40000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=-220.78, model_b surplus=2161.22
âœ… Calculated utility_surplus: {'model_a': -220.77500000000146, 'model_b': 2161.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 0.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_a': 39558.45, 'model_b': 40000.0}
Metrics: {'utility_surplus': {'model_a': -220.77500000000146, 'model_b': 2161.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 0.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 295 completed successfully
Wed Nov 19 06:31:18 PM CET 2025: Completed iteration 295

=== Iteration 296/300 ===
Wed Nov 19 06:31:18 PM CET 2025: Starting company car negotiation iteration 296 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.55s (total since entry 12.10s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.42s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.97s (total since entry 5.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬39,000 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 1: price=39000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: 2000.00 (saved â‚¬2000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 0.00 (profit â‚¬0.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=43000.00, seller=39000.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=2000.00, model_b surplus=0.00
âœ… Calculated utility_surplus: {'model_a': 2000.0, 'model_b': 0.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_a': 43000.0, 'model_b': 39000.0}
Metrics: {'utility_surplus': {'model_a': 2000.0, 'model_b': 0.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 296 completed successfully
Wed Nov 19 06:31:43 PM CET 2025: Completed iteration 296

=== Iteration 297/300 ===
Wed Nov 19 06:31:43 PM CET 2025: Starting company car negotiation iteration 297 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.50s (total since entry 12.05s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 4.99s (total since entry 5.40s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 26000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 26000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 26000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 26000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 26000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 26000.0}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬26,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37950}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37950}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37950}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37950}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37950}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37950.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬37,950 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38900\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38900\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38900\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38900}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38900}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38900.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 37000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 37000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 37000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 37000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 37000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 37000.0}
ğŸ’¡ Player model_a made offer â‚¬38,900 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬37,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38600}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38600}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38600}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38600}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38600}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38600.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,600 (proposal 4/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 4/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_a accepted offer of â‚¬38,500 (made in round 4)
ğŸ” [BATNA DEBUG] Round 5: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=38594.80, seller=36712.13
ğŸ” [SURPLUS DEBUG] Buyer surplus: 94.80 (saved â‚¬94.80 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1787.87 (profit â‚¬1787.87 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=38689.60, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=94.80, model_a surplus=1787.87
âœ… Calculated utility_surplus: {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 5
Final utilities: {'model_b': 38689.59715125, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 1787.8745256249967, 'model_b': 94.7985756249982}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 297 completed successfully
Wed Nov 19 06:32:18 PM CET 2025: Completed iteration 297

=== Iteration 298/300 ===
Wed Nov 19 06:32:18 PM CET 2025: Starting company car negotiation iteration 298 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.57s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.47s (total since entry 12.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.43s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.03s (total since entry 5.45s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 41000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 41000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 41000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 41000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 41000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 41000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ’¡ Player model_b made offer â‚¬41,000 (proposal 1/4)
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n    "type": "offer",\n    "price": 39000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n    "type": "offer",\n    "price": 39000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬39,000 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 38500\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 38500\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,500 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 3/4)
ğŸ‰ CONVERGENCE! Both players offered â‚¬38,500 - Creating automatic agreement!
ğŸ” [BATNA DEBUG] Round 3: price=38500
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39779.22, seller=37838.78
ğŸ” [SURPLUS DEBUG] Buyer surplus: 1279.22 (saved â‚¬1279.22 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 661.22 (profit â‚¬661.22 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=41058.45, seller=38500.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=1279.22, model_a surplus=661.22
âœ… Calculated utility_surplus: {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 3
Final utilities: {'model_b': 41058.45, 'model_a': 38500.0}
Metrics: {'utility_surplus': {'model_a': 661.2249999999985, 'model_b': 1279.2249999999985}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 298 completed successfully
Wed Nov 19 06:32:44 PM CET 2025: Completed iteration 298

=== Iteration 299/300 ===
Wed Nov 19 06:32:44 PM CET 2025: Starting company car negotiation iteration 299 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.54s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.51s (total since entry 12.06s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.41s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.05s (total since entry 5.47s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_a = BUYER, model_b = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n  "type": "offer",\n  "price": 40000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n  "type": "offer",\n  "price": 40000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 39000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 39000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 39000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 39000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 39000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 39000.0}
ğŸ’¡ Player model_a made offer â‚¬40,000 (proposal 1/4)
ğŸ’¡ Player model_b made offer â‚¬39,000 (proposal 1/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38750}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{"type": "offer", "price": 38750}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{"type": "offer", "price": 38750}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38750}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38750}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38750.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 38500}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 38500}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 38500}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 38500}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38500}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 38500.0}
ğŸ’¡ Player model_a made offer â‚¬38,750 (proposal 2/4)
ğŸ’¡ Player model_b made offer â‚¬38,500 (proposal 2/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 38400\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 38400\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 38400}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 38400}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 38400.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "offer", "price": 40000}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "offer", "price": 40000}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "offer", "price": 40000}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'offer', 'price': 40000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 40000}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'offer', 'price': 40000.0}
ğŸ’¡ Player model_a made offer â‚¬38,400 (proposal 3/4)
ğŸ’¡ Player model_b made offer â‚¬40,000 (proposal 3/4)
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
âœ… Player model_b accepted offer of â‚¬38,400 (made in round 3)
ğŸ” [BATNA DEBUG] Round 4: price=38400
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=39182.54, seller=37271.19
ğŸ” [SURPLUS DEBUG] Buyer surplus: 782.54 (saved â‚¬782.54 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 1128.81 (profit â‚¬1128.81 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=39965.07, seller=38400.00
ğŸ² [ROLE DEBUG] Buyer=model_a, Seller=model_b
ğŸ² [ROLE DEBUG] model_a surplus=782.54, model_b surplus=1128.81
âœ… Calculated utility_surplus: {'model_a': 782.5366249999934, 'model_b': 1128.8066250000047}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 1.0}
ğŸ† [LLM WINNER] Qwen/Qwen2.5-3B beat mistralai/Mistral-7B-Instruct-v0.3 (player model_b won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 4
Final utilities: {'model_a': 39965.07324999999, 'model_b': 38400.0}
Metrics: {'utility_surplus': {'model_a': 782.5366249999934, 'model_b': 1128.8066250000047}, 'risk_minimization': {'model_a': 100.0, 'model_b': 100.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 1.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 299 completed successfully
Wed Nov 19 06:33:13 PM CET 2025: Completed iteration 299

=== Iteration 300/300 ===
Wed Nov 19 06:33:13 PM CET 2025: Starting company car negotiation iteration 300 on node jn004
=== Negotiation Platform ===
Available models: ['model_a', 'model_b', 'model_c']
Using models: ['model_a', 'model_b', 'model_c']

=== Running Single Company Car Negotiation ===
[DEBUG] LLMManager received model_configs: {'model_a': {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_b': {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}, 'model_c': {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}}
[DEBUG] Type of model_configs: <class 'dict'>
[DEBUG] Keys in model_configs: ['model_a', 'model_b', 'model_c']
[DEBUG] Attempting to register 3 models...
[DEBUG] Processing model: model_a
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'mistralai/Mistral-7B-Instruct-v0.3', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_a (new instance for mistralai/Mistral-7B-Instruct-v0.3)
[DEBUG] Processing model: model_b
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'Qwen/Qwen2.5-3B', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.7, 'max_length': 16, 'do_sample': True, 'trust_remote_code': True, 'load_in_8bit': False, 'api_token': '...'}}
ğŸ“ Registered model: model_b (new instance for Qwen/Qwen2.5-3B)
[DEBUG] Processing model: model_c
[DEBUG] Model config: {'type': 'huggingface', 'model_name': 'meta-llama/Llama-3.2-3B-Instruct', 'config': {'device': 'cuda', 'device_map': 'auto', 'temperature': 0.0, 'max_length': 16, 'do_sample': False, 'pad_token_id': 50256, 'trust_remote_code': False, 'load_in_8bit': True, 'api_token': '...'}}
ğŸ“ Registered model: model_c (new instance for meta-llama/Llama-3.2-3B-Instruct)
ğŸ“Š Registered metric: utility_surplus - Utility Surplus
ğŸ“Š Registered metric: risk_minimization - Risk Minimization
ğŸ“Š Registered metric: deadline_sensitivity - Deadline Sensitivity
ğŸ“Š Registered metric: feasibility - Feasibility
ğŸ”„ Models will be loaded on-demand: ['model_a', 'model_b', 'model_c']
ğŸ”„ [DEBUG] Loading model: model_a
ğŸš€ Loading model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
Loading mistralai/Mistral-7B-Instruct-v0.3...
ğŸ”§ TorchDynamo is ENABLED (consider TORCHDYNAMO_DISABLE=1 if hanging)
ğŸ”§ DISABLING TorchDynamo to prevent potential hanging...
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.53s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='mistralai/Mistral-7B-Instruct-v0.3'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('mistralai/Mistral-7B-Instruct-v0.3', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 11.57s (total since entry 12.12s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 14439
âœ… mistralai/Mistral-7B-Instruct-v0.3 loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_a]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loading model: model_b
ğŸš€ Loading model: model_b (shared name: Qwen/Qwen2.5-3B)
Loading Qwen/Qwen2.5-3B...
ğŸ”§ TorchDynamo is DISABLED via environment variable
ğŸ”§ Environment: transformers=4.53.2, torch=2.7.1+cu126
ğŸ”§ CUDA available: True, device_count: 1
ğŸ” Starting tokenizer.from_pretrained()
âœ… Tokenizer loaded in 0.44s
ğŸ”§ Building model kwargs...
ğŸ”§ Using configured device_map: auto
âœ… Model kwargs built in 0.00s
ï¿½ Model kwargs keys: ['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map']
ğŸ”§ device_map: auto
ğŸ”§ torch_dtype: torch.float16
ğŸ”§ low_cpu_mem_usage: True
ğŸ”§ trust_remote_code: True
ï¿½ğŸ” Starting AutoModelForCausalLM.from_pretrained() with model_name='Qwen/Qwen2.5-3B'
ğŸ”§ About to call: AutoModelForCausalLM.from_pretrained('Qwen/Qwen2.5-3B', **['token', 'torch_dtype', 'trust_remote_code', 'low_cpu_mem_usage', 'device_map'])
ğŸ”§ Starting model load (optimized settings)...
âœ… Model loaded successfully in 5.02s (total since entry 5.46s)
ğŸ”§ [INFO] First model parameter device after load: cuda:0
ğŸ”§ [GPU] nvidia-smi output:
0, 20879
âœ… Qwen/Qwen2.5-3B loaded successfully
ğŸ”„ [DEBUG] Loaded model type: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Loaded model is None: False
ğŸ”„ [DEBUG] stored in loaded_agents[model_b]: <class 'negotiation_platform.models.hf_model_wrapper.HuggingFaceModelWrapper'>
ğŸ”„ [DEBUG] Final loaded_agents keys: ['model_a', 'model_b']
ğŸ”„ [DEBUG] Players list: ['model_a', 'model_b']
ğŸ² [ROLE ASSIGNMENT] model_b = BUYER, model_a = SELLER
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ” [DEBUG] [model_a] Raw LLM response: '{\n"type": "offer",\n"price": 42000\n}'
ğŸ§¹ [DEBUG] [model_a] Extracted JSON from start: '{\n"type": "offer",\n"price": 42000\n}'
âœ… [DEBUG] [model_a] Successfully parsed JSON from start: {'type': 'offer', 'price': 42000}
[DEBUG] Parsed JSON: {'type': 'offer', 'price': 42000}
âœ… [DEBUG] [model_a] Pydantic validation successful: {'type': 'offer', 'price': 42000.0}
ğŸ”§ [DEBUG] Model device: cuda:0
ğŸ”§ [DEBUG] Moved inputs to device: cuda:0
ğŸ§¹ [DEBUG] Extracted JSON from start: '{"type": "accept"}'
ğŸ” [DEBUG] [model_b] Raw LLM response: '{"type": "accept"}'
ğŸ§¹ [DEBUG] [model_b] Extracted JSON from start: '{"type": "accept"}'
âœ… [DEBUG] [model_b] Successfully parsed JSON from start: {'type': 'accept'}
[DEBUG] Parsed JSON: {'type': 'accept'}
âœ… [DEBUG] [model_b] Pydantic validation successful: {'type': 'accept'}
ğŸ’¡ Player model_a made offer â‚¬42,000 (proposal 1/4)
âœ… Player model_b accepted offer of â‚¬42,000 (made in round 1)
ğŸ” [BATNA DEBUG] Round 1: price=42000
ğŸ” [BATNA DEBUG] Config BATNAs: buyer=41000, seller=39000
ğŸ” [BATNA DEBUG] Decay rate: {'buyer': 0.015, 'seller': 0.015}
ğŸ” [BATNA DEBUG] Calculated BATNAs: buyer=41000.00, seller=39000.00
ğŸ” [SURPLUS DEBUG] Buyer surplus: -1000.00 (saved â‚¬-1000.00 vs BATNA)
ğŸ” [SURPLUS DEBUG] Seller surplus: 3000.00 (profit â‚¬3000.00 over BATNA)
ğŸ” [UTILITY DEBUG] Final utilities (for session manager): buyer=40000.00, seller=42000.00
ğŸ² [ROLE DEBUG] Buyer=model_b, Seller=model_a
ğŸ² [ROLE DEBUG] model_b surplus=-1000.00, model_a surplus=3000.00
âœ… Calculated utility_surplus: {'model_a': 3000.0, 'model_b': -1000.0}
âœ… Calculated risk_minimization: {'model_a': 100.0, 'model_b': 0.0}
âœ… Calculated deadline_sensitivity: {'model_a': 100.0, 'model_b': 100.0}
âœ… Calculated feasibility: {'model_a': 1.0, 'model_b': 0.0}
ğŸ† [LLM WINNER] mistralai/Mistral-7B-Instruct-v0.3 beat Qwen/Qwen2.5-3B (player model_a won)
ğŸ¤– [MODEL MAPPING] model_a=Mistral-7B-Instruct-v0.3, model_b=Qwen2.5-3B
ğŸ—‘ï¸  mistralai/Mistral-7B-Instruct-v0.3 unloaded
ğŸ—‘ï¸  Unloaded model: model_a (shared name: mistralai/Mistral-7B-Instruct-v0.3)
ğŸ—‘ï¸  Qwen/Qwen2.5-3B unloaded
ğŸ—‘ï¸  Unloaded model: model_b (shared name: Qwen/Qwen2.5-3B)
Agreement reached: True
Agreement round: 1
Final utilities: {'model_b': 40000.0, 'model_a': 42000.0}
Metrics: {'utility_surplus': {'model_a': 3000.0, 'model_b': -1000.0}, 'risk_minimization': {'model_a': 100.0, 'model_b': 0.0}, 'deadline_sensitivity': {'model_a': 100.0, 'model_b': 100.0}, 'feasibility': {'model_a': 1.0, 'model_b': 0.0}}
ğŸ”„ Keeping models loaded for potential reuse

Platform completed successfully!
âœ… Iteration 300 completed successfully
Wed Nov 19 06:33:35 PM CET 2025: Completed iteration 300

=== Company Car Game Batch Complete ===
Successful iterations: 300/300
âœ… ALL ITERATIONS SUCCESSFUL: Platform working perfectly on node jn004
=== Company Car Run Complete ===
